/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_runner_workspace_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/login/route.ts */ \"(rsc)/./app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"/home/runner/workspace/app/api/auth/login/route.ts\",\n    nextConfigOutput,\n    userland: _home_runner_workspace_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGcnVubmVyJTJGd29ya3NwYWNlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZob21lJTJGcnVubmVyJTJGd29ya3NwYWNlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLz84MTAwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL2xvZ2luL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9sb2dpblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL2xvZ2luL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/login/route.ts":
/*!*************************************!*\
  !*** ./app/api/auth/login/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var openid_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openid-client */ \"(rsc)/./node_modules/openid-client/build/index.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\n\nasync function GET(request) {\n    try {\n        const config = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getOidcConfig)();\n        const session = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getSession)();\n        // Use REPLIT_DOMAINS environment variable for the correct callback URL\n        const replitDomain = process.env.REPLIT_DOMAINS?.split(\",\")[0];\n        const callbackUrl = replitDomain ? `https://${replitDomain}/api/auth/callback` : `${request.nextUrl.origin}/api/auth/callback`;\n        console.log(\"Callback URL:\", callbackUrl);\n        const codeVerifier = openid_client__WEBPACK_IMPORTED_MODULE_2__.randomPKCECodeVerifier();\n        const codeChallenge = await openid_client__WEBPACK_IMPORTED_MODULE_2__.calculatePKCECodeChallenge(codeVerifier);\n        const state = openid_client__WEBPACK_IMPORTED_MODULE_2__.randomState();\n        session.codeVerifier = codeVerifier;\n        session.state = state;\n        await session.save();\n        const authUrl = openid_client__WEBPACK_IMPORTED_MODULE_2__.buildAuthorizationUrl(config, {\n            redirect_uri: callbackUrl,\n            scope: \"openid email profile offline_access\",\n            code_challenge: codeChallenge,\n            code_challenge_method: \"S256\",\n            state: state,\n            prompt: \"login consent\"\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(authUrl.href);\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Login failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUNoQjtBQUNlO0FBRWhELGVBQWVJLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNQyxTQUFTLE1BQU1KLHdEQUFhQTtRQUNsQyxNQUFNSyxVQUFVLE1BQU1KLHFEQUFVQTtRQUVoQyx1RUFBdUU7UUFDdkUsTUFBTUssZUFBZUMsUUFBUUMsR0FBRyxDQUFDQyxjQUFjLEVBQUVDLE1BQU0sSUFBSSxDQUFDLEVBQUU7UUFDOUQsTUFBTUMsY0FBY0wsZUFDaEIsQ0FBQyxRQUFRLEVBQUVBLGFBQWEsa0JBQWtCLENBQUMsR0FDM0MsQ0FBQyxFQUFFSCxRQUFRUyxPQUFPLENBQUNDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQztRQUVqREMsUUFBUUMsR0FBRyxDQUFDLGlCQUFpQko7UUFFN0IsTUFBTUssZUFBZWpCLGlFQUE2QjtRQUNsRCxNQUFNbUIsZ0JBQWdCLE1BQU1uQixxRUFBaUMsQ0FBQ2lCO1FBQzlELE1BQU1JLFFBQVFyQixzREFBa0I7UUFFaENNLFFBQVFXLFlBQVksR0FBR0E7UUFDdkJYLFFBQVFlLEtBQUssR0FBR0E7UUFDaEIsTUFBTWYsUUFBUWlCLElBQUk7UUFFbEIsTUFBTUMsVUFBVXhCLGdFQUE0QixDQUFDSyxRQUFRO1lBQ25EcUIsY0FBY2Q7WUFDZGUsT0FBTztZQUNQQyxnQkFBZ0JUO1lBQ2hCVSx1QkFBdUI7WUFDdkJSLE9BQU9BO1lBQ1BTLFFBQVE7UUFDVjtRQUVBLE9BQU8vQixxREFBWUEsQ0FBQ2dDLFFBQVEsQ0FBQ1AsUUFBUVEsSUFBSTtJQUMzQyxFQUFFLE9BQU9DLE9BQU87UUFDZGxCLFFBQVFrQixLQUFLLENBQUMsZ0JBQWdCQTtRQUM5QixPQUFPbEMscURBQVlBLENBQUNtQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFlLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3RFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZXN0LWV4cHJlc3MvLi9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHM/NGYyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgKiBhcyBjbGllbnQgZnJvbSBcIm9wZW5pZC1jbGllbnRcIjtcbmltcG9ydCB7IGdldE9pZGNDb25maWcsIGdldFNlc3Npb24gfSBmcm9tIFwiQC9saWIvYXV0aFwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgZ2V0T2lkY0NvbmZpZygpO1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKCk7XG4gICAgXG4gICAgLy8gVXNlIFJFUExJVF9ET01BSU5TIGVudmlyb25tZW50IHZhcmlhYmxlIGZvciB0aGUgY29ycmVjdCBjYWxsYmFjayBVUkxcbiAgICBjb25zdCByZXBsaXREb21haW4gPSBwcm9jZXNzLmVudi5SRVBMSVRfRE9NQUlOUz8uc3BsaXQoXCIsXCIpWzBdO1xuICAgIGNvbnN0IGNhbGxiYWNrVXJsID0gcmVwbGl0RG9tYWluIFxuICAgICAgPyBgaHR0cHM6Ly8ke3JlcGxpdERvbWFpbn0vYXBpL2F1dGgvY2FsbGJhY2tgXG4gICAgICA6IGAke3JlcXVlc3QubmV4dFVybC5vcmlnaW59L2FwaS9hdXRoL2NhbGxiYWNrYDtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIkNhbGxiYWNrIFVSTDpcIiwgY2FsbGJhY2tVcmwpO1xuICAgIFxuICAgIGNvbnN0IGNvZGVWZXJpZmllciA9IGNsaWVudC5yYW5kb21QS0NFQ29kZVZlcmlmaWVyKCk7XG4gICAgY29uc3QgY29kZUNoYWxsZW5nZSA9IGF3YWl0IGNsaWVudC5jYWxjdWxhdGVQS0NFQ29kZUNoYWxsZW5nZShjb2RlVmVyaWZpZXIpO1xuICAgIGNvbnN0IHN0YXRlID0gY2xpZW50LnJhbmRvbVN0YXRlKCk7XG4gICAgXG4gICAgc2Vzc2lvbi5jb2RlVmVyaWZpZXIgPSBjb2RlVmVyaWZpZXI7XG4gICAgc2Vzc2lvbi5zdGF0ZSA9IHN0YXRlO1xuICAgIGF3YWl0IHNlc3Npb24uc2F2ZSgpO1xuICAgIFxuICAgIGNvbnN0IGF1dGhVcmwgPSBjbGllbnQuYnVpbGRBdXRob3JpemF0aW9uVXJsKGNvbmZpZywge1xuICAgICAgcmVkaXJlY3RfdXJpOiBjYWxsYmFja1VybCxcbiAgICAgIHNjb3BlOiBcIm9wZW5pZCBlbWFpbCBwcm9maWxlIG9mZmxpbmVfYWNjZXNzXCIsXG4gICAgICBjb2RlX2NoYWxsZW5nZTogY29kZUNoYWxsZW5nZSxcbiAgICAgIGNvZGVfY2hhbGxlbmdlX21ldGhvZDogXCJTMjU2XCIsXG4gICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICBwcm9tcHQ6IFwibG9naW4gY29uc2VudFwiLFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QoYXV0aFVybC5ocmVmKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiTG9naW4gZXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBtZXNzYWdlOiBcIkxvZ2luIGZhaWxlZFwiIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjbGllbnQiLCJnZXRPaWRjQ29uZmlnIiwiZ2V0U2Vzc2lvbiIsIkdFVCIsInJlcXVlc3QiLCJjb25maWciLCJzZXNzaW9uIiwicmVwbGl0RG9tYWluIiwicHJvY2VzcyIsImVudiIsIlJFUExJVF9ET01BSU5TIiwic3BsaXQiLCJjYWxsYmFja1VybCIsIm5leHRVcmwiLCJvcmlnaW4iLCJjb25zb2xlIiwibG9nIiwiY29kZVZlcmlmaWVyIiwicmFuZG9tUEtDRUNvZGVWZXJpZmllciIsImNvZGVDaGFsbGVuZ2UiLCJjYWxjdWxhdGVQS0NFQ29kZUNoYWxsZW5nZSIsInN0YXRlIiwicmFuZG9tU3RhdGUiLCJzYXZlIiwiYXV0aFVybCIsImJ1aWxkQXV0aG9yaXphdGlvblVybCIsInJlZGlyZWN0X3VyaSIsInNjb3BlIiwiY29kZV9jaGFsbGVuZ2UiLCJjb2RlX2NoYWxsZW5nZV9tZXRob2QiLCJwcm9tcHQiLCJyZWRpcmVjdCIsImhyZWYiLCJlcnJvciIsImpzb24iLCJtZXNzYWdlIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./shared/schema.ts":
/*!**************************!*\
  !*** ./shared/schema.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   expenses: () => (/* binding */ expenses),\n/* harmony export */   insertAdminSchema: () => (/* binding */ insertAdminSchema),\n/* harmony export */   insertExpenseSchema: () => (/* binding */ insertExpenseSchema),\n/* harmony export */   insertOutletSchema: () => (/* binding */ insertOutletSchema),\n/* harmony export */   insertSalesSchema: () => (/* binding */ insertSalesSchema),\n/* harmony export */   outlets: () => (/* binding */ outlets),\n/* harmony export */   sales: () => (/* binding */ sales),\n/* harmony export */   sessions: () => (/* binding */ sessions),\n/* harmony export */   updateExpenseSchema: () => (/* binding */ updateExpenseSchema),\n/* harmony export */   updateSalesSchema: () => (/* binding */ updateSalesSchema),\n/* harmony export */   users: () => (/* binding */ users)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/table.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/varchar.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/jsonb.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/timestamp.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/indexes.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/real.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/integer.js\");\n/* harmony import */ var drizzle_zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-zod */ \"(rsc)/./node_modules/drizzle-zod/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/lib/index.mjs\");\n\n\n\n\n// Session storage table - Required for Replit Auth\nconst sessions = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)(\"sessions\", {\n    sid: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"sid\").primaryKey(),\n    sess: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.jsonb)(\"sess\").notNull(),\n    expire: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"expire\").notNull()\n}, (table)=>[\n        (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.index)(\"IDX_session_expire\").on(table.expire)\n    ]);\n// Users table - Extended from Replit Auth with role-based access\n// password field is optional - only used for admin users created by SUPER_ADMIN\nconst users = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)(\"users\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"id\").primaryKey().default((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.sql)`gen_random_uuid()`),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"email\").unique(),\n    firstName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"first_name\"),\n    lastName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"last_name\"),\n    profileImageUrl: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"profile_image_url\"),\n    role: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"role\").$type().notNull().default(\"finance\"),\n    password: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"password\"),\n    assignedOutletId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"assigned_outlet_id\"),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"created_at\").defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"updated_at\").defaultNow()\n});\n// Schema for creating admin users (by SUPER_ADMIN)\nconst insertAdminSchema = zod__WEBPACK_IMPORTED_MODULE_7__.z.object({\n    email: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().email(\"Format email tidak valid\"),\n    firstName: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().min(1, \"Nama harus diisi\"),\n    lastName: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().optional(),\n    password: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().min(8, \"Password minimal 8 karakter\"),\n    role: zod__WEBPACK_IMPORTED_MODULE_7__.z.enum([\n        \"owner\",\n        \"admin_outlet\",\n        \"finance\"\n    ], {\n        errorMap: ()=>({\n                message: \"Role tidak valid\"\n            })\n    }),\n    assignedOutletId: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().optional()\n});\n// Outlets table\nconst outlets = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)(\"outlets\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"id\").primaryKey().default((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.sql)`gen_random_uuid()`),\n    name: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"name\").notNull(),\n    cogsPerPiece: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"cogs_per_piece\").notNull().default(0),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"created_at\").notNull().defaultNow()\n});\nconst insertOutletSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_0__.createInsertSchema)(outlets).omit({\n    id: true,\n    createdAt: true\n});\n// Sales records table\nconst sales = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)(\"sales\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"id\").primaryKey().default((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.sql)`gen_random_uuid()`),\n    outletId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"outlet_id\").notNull(),\n    date: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"date\").notNull(),\n    cash: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"cash\").notNull().default(0),\n    qris: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"qris\").notNull().default(0),\n    grab: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"grab\").notNull().default(0),\n    gofood: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"gofood\").notNull().default(0),\n    shopee: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"shopee\").notNull().default(0),\n    tiktok: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"tiktok\").notNull().default(0),\n    totalSold: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_10__.integer)(\"total_sold\").notNull().default(0),\n    remaining: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_10__.integer)(\"remaining\").notNull().default(0),\n    returned: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_10__.integer)(\"returned\").notNull().default(0),\n    totalProduction: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_10__.integer)(\"total_production\").notNull().default(0),\n    soldOutTime: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"sold_out_time\"),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"created_at\").notNull().defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"updated_at\").notNull().defaultNow()\n});\nconst insertSalesSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_0__.createInsertSchema)(sales).omit({\n    id: true,\n    createdAt: true,\n    updatedAt: true\n}).extend({\n    cash: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"Cash harus >= 0\"),\n    qris: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"QRIS harus >= 0\"),\n    grab: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"Grab harus >= 0\"),\n    gofood: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"GoFood harus >= 0\"),\n    shopee: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"Shopee harus >= 0\"),\n    tiktok: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"TikTok harus >= 0\"),\n    totalSold: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().int().min(0, \"Total terjual harus >= 0\"),\n    remaining: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().int().min(0, \"Sisa harus >= 0\"),\n    returned: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().int().min(0, \"Return harus >= 0\"),\n    totalProduction: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().int().min(0, \"Total produksi harus >= 0\")\n});\nconst updateSalesSchema = insertSalesSchema.partial();\n// Expenses table\nconst expenses = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)(\"expenses\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"id\").primaryKey().default((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.sql)`gen_random_uuid()`),\n    outletId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"outlet_id\").notNull(),\n    date: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"date\").notNull(),\n    type: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"type\").$type().notNull(),\n    description: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"description\").notNull(),\n    amount: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_9__.real)(\"amount\").notNull().default(0),\n    proofUrl: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.text)(\"proof_url\"),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"created_at\").notNull().defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)(\"updated_at\").notNull().defaultNow()\n});\nconst insertExpenseSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_0__.createInsertSchema)(expenses).omit({\n    id: true,\n    createdAt: true,\n    updatedAt: true\n}).extend({\n    amount: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"Jumlah harus >= 0\"),\n    type: zod__WEBPACK_IMPORTED_MODULE_7__.z.enum([\n        \"harian\",\n        \"bulanan\",\n        \"gaji\"\n    ], {\n        errorMap: ()=>({\n                message: \"Jenis harus 'harian', 'bulanan', atau 'gaji'\"\n            })\n    }),\n    description: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().min(1, \"Deskripsi harus diisi\"),\n    proofUrl: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().optional()\n});\nconst updateExpenseSchema = zod__WEBPACK_IMPORTED_MODULE_7__.z.object({\n    outletId: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().optional(),\n    date: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().optional(),\n    type: zod__WEBPACK_IMPORTED_MODULE_7__.z.enum([\n        \"harian\",\n        \"bulanan\",\n        \"gaji\"\n    ], {\n        errorMap: ()=>({\n                message: \"Jenis harus 'harian', 'bulanan', atau 'gaji'\"\n            })\n    }).optional(),\n    description: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().min(1, \"Deskripsi harus diisi\").optional(),\n    amount: zod__WEBPACK_IMPORTED_MODULE_7__.z.number().min(0, \"Jumlah harus >= 0\").optional(),\n    proofUrl: zod__WEBPACK_IMPORTED_MODULE_7__.z.string().nullable().optional()\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxrQ0FBQ0EsQ0FBQzBCLE1BQU0sR0FBR3NDLFFBQVEsR0FBR3BDLFFBQVE7QUFDMUMsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3Jlc3QtZXhwcmVzcy8uL3NoYXJlZC9zY2hlbWEudHM/MWI0MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcWwgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcbmltcG9ydCB7IHBnVGFibGUsIHRleHQsIHZhcmNoYXIsIGludGVnZXIsIHJlYWwsIHRpbWVzdGFtcCwganNvbmIsIGluZGV4IH0gZnJvbSBcImRyaXp6bGUtb3JtL3BnLWNvcmVcIjtcbmltcG9ydCB7IGNyZWF0ZUluc2VydFNjaGVtYSB9IGZyb20gXCJkcml6emxlLXpvZFwiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcblxuLy8gU2Vzc2lvbiBzdG9yYWdlIHRhYmxlIC0gUmVxdWlyZWQgZm9yIFJlcGxpdCBBdXRoXG5leHBvcnQgY29uc3Qgc2Vzc2lvbnMgPSBwZ1RhYmxlKFxuICBcInNlc3Npb25zXCIsXG4gIHtcbiAgICBzaWQ6IHZhcmNoYXIoXCJzaWRcIikucHJpbWFyeUtleSgpLFxuICAgIHNlc3M6IGpzb25iKFwic2Vzc1wiKS5ub3ROdWxsKCksXG4gICAgZXhwaXJlOiB0aW1lc3RhbXAoXCJleHBpcmVcIikubm90TnVsbCgpLFxuICB9LFxuICAodGFibGUpID0+IFtpbmRleChcIklEWF9zZXNzaW9uX2V4cGlyZVwiKS5vbih0YWJsZS5leHBpcmUpXSxcbik7XG5cbi8vIFVzZXIgcm9sZXMgZW51bSAtIEFkZGVkIHN1cGVyX2FkbWluIGZvciBtYW5hZ2luZyBvdGhlciBhZG1pbnNcbmV4cG9ydCB0eXBlIFVzZXJSb2xlID0gXCJzdXBlcl9hZG1pblwiIHwgXCJvd25lclwiIHwgXCJhZG1pbl9vdXRsZXRcIiB8IFwiZmluYW5jZVwiO1xuXG4vLyBVc2VycyB0YWJsZSAtIEV4dGVuZGVkIGZyb20gUmVwbGl0IEF1dGggd2l0aCByb2xlLWJhc2VkIGFjY2Vzc1xuLy8gcGFzc3dvcmQgZmllbGQgaXMgb3B0aW9uYWwgLSBvbmx5IHVzZWQgZm9yIGFkbWluIHVzZXJzIGNyZWF0ZWQgYnkgU1VQRVJfQURNSU5cbmV4cG9ydCBjb25zdCB1c2VycyA9IHBnVGFibGUoXCJ1c2Vyc1wiLCB7XG4gIGlkOiB2YXJjaGFyKFwiaWRcIikucHJpbWFyeUtleSgpLmRlZmF1bHQoc3FsYGdlbl9yYW5kb21fdXVpZCgpYCksXG4gIGVtYWlsOiB2YXJjaGFyKFwiZW1haWxcIikudW5pcXVlKCksXG4gIGZpcnN0TmFtZTogdmFyY2hhcihcImZpcnN0X25hbWVcIiksXG4gIGxhc3ROYW1lOiB2YXJjaGFyKFwibGFzdF9uYW1lXCIpLFxuICBwcm9maWxlSW1hZ2VVcmw6IHZhcmNoYXIoXCJwcm9maWxlX2ltYWdlX3VybFwiKSxcbiAgcm9sZTogdmFyY2hhcihcInJvbGVcIikuJHR5cGU8VXNlclJvbGU+KCkubm90TnVsbCgpLmRlZmF1bHQoXCJmaW5hbmNlXCIpLFxuICBwYXNzd29yZDogdmFyY2hhcihcInBhc3N3b3JkXCIpLCAvLyBIYXNoZWQgcGFzc3dvcmQgZm9yIGFkbWluIHVzZXJzIChudWxsIGZvciBSZXBsaXQgQXV0aCB1c2VycylcbiAgYXNzaWduZWRPdXRsZXRJZDogdmFyY2hhcihcImFzc2lnbmVkX291dGxldF9pZFwiKSwgLy8gRm9yIGFkbWluX291dGxldCByb2xlXG4gIGNyZWF0ZWRBdDogdGltZXN0YW1wKFwiY3JlYXRlZF9hdFwiKS5kZWZhdWx0Tm93KCksXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKFwidXBkYXRlZF9hdFwiKS5kZWZhdWx0Tm93KCksXG59KTtcblxuZXhwb3J0IHR5cGUgVXBzZXJ0VXNlciA9IHR5cGVvZiB1c2Vycy4kaW5mZXJJbnNlcnQ7XG5leHBvcnQgdHlwZSBVc2VyID0gdHlwZW9mIHVzZXJzLiRpbmZlclNlbGVjdDtcblxuLy8gU2NoZW1hIGZvciBjcmVhdGluZyBhZG1pbiB1c2VycyAoYnkgU1VQRVJfQURNSU4pXG5leHBvcnQgY29uc3QgaW5zZXJ0QWRtaW5TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKFwiRm9ybWF0IGVtYWlsIHRpZGFrIHZhbGlkXCIpLFxuICBmaXJzdE5hbWU6IHouc3RyaW5nKCkubWluKDEsIFwiTmFtYSBoYXJ1cyBkaWlzaVwiKSxcbiAgbGFzdE5hbWU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubWluKDgsIFwiUGFzc3dvcmQgbWluaW1hbCA4IGthcmFrdGVyXCIpLFxuICByb2xlOiB6LmVudW0oW1wib3duZXJcIiwgXCJhZG1pbl9vdXRsZXRcIiwgXCJmaW5hbmNlXCJdLCB7XG4gICAgZXJyb3JNYXA6ICgpID0+ICh7IG1lc3NhZ2U6IFwiUm9sZSB0aWRhayB2YWxpZFwiIH0pLFxuICB9KSxcbiAgYXNzaWduZWRPdXRsZXRJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxufSk7XG5cbmV4cG9ydCB0eXBlIEluc2VydEFkbWluID0gei5pbmZlcjx0eXBlb2YgaW5zZXJ0QWRtaW5TY2hlbWE+O1xuXG4vLyBPdXRsZXRzIHRhYmxlXG5leHBvcnQgY29uc3Qgb3V0bGV0cyA9IHBnVGFibGUoXCJvdXRsZXRzXCIsIHtcbiAgaWQ6IHZhcmNoYXIoXCJpZFwiKS5wcmltYXJ5S2V5KCkuZGVmYXVsdChzcWxgZ2VuX3JhbmRvbV91dWlkKClgKSxcbiAgbmFtZTogdGV4dChcIm5hbWVcIikubm90TnVsbCgpLFxuICBjb2dzUGVyUGllY2U6IHJlYWwoXCJjb2dzX3Blcl9waWVjZVwiKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoXCJjcmVhdGVkX2F0XCIpLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXG59KTtcblxuZXhwb3J0IGNvbnN0IGluc2VydE91dGxldFNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYShvdXRsZXRzKS5vbWl0KHtcbiAgaWQ6IHRydWUsXG4gIGNyZWF0ZWRBdDogdHJ1ZSxcbn0pO1xuXG5leHBvcnQgdHlwZSBJbnNlcnRPdXRsZXQgPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRPdXRsZXRTY2hlbWE+O1xuZXhwb3J0IHR5cGUgT3V0bGV0ID0gdHlwZW9mIG91dGxldHMuJGluZmVyU2VsZWN0O1xuXG4vLyBTYWxlcyByZWNvcmRzIHRhYmxlXG5leHBvcnQgY29uc3Qgc2FsZXMgPSBwZ1RhYmxlKFwic2FsZXNcIiwge1xuICBpZDogdmFyY2hhcihcImlkXCIpLnByaW1hcnlLZXkoKS5kZWZhdWx0KHNxbGBnZW5fcmFuZG9tX3V1aWQoKWApLFxuICBvdXRsZXRJZDogdmFyY2hhcihcIm91dGxldF9pZFwiKS5ub3ROdWxsKCksXG4gIGRhdGU6IHRleHQoXCJkYXRlXCIpLm5vdE51bGwoKSwgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgY2FzaDogcmVhbChcImNhc2hcIikubm90TnVsbCgpLmRlZmF1bHQoMCksXG4gIHFyaXM6IHJlYWwoXCJxcmlzXCIpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICBncmFiOiByZWFsKFwiZ3JhYlwiKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgZ29mb29kOiByZWFsKFwiZ29mb29kXCIpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICBzaG9wZWU6IHJlYWwoXCJzaG9wZWVcIikubm90TnVsbCgpLmRlZmF1bHQoMCksXG4gIHRpa3RvazogcmVhbChcInRpa3Rva1wiKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgdG90YWxTb2xkOiBpbnRlZ2VyKFwidG90YWxfc29sZFwiKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgcmVtYWluaW5nOiBpbnRlZ2VyKFwicmVtYWluaW5nXCIpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICByZXR1cm5lZDogaW50ZWdlcihcInJldHVybmVkXCIpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICB0b3RhbFByb2R1Y3Rpb246IGludGVnZXIoXCJ0b3RhbF9wcm9kdWN0aW9uXCIpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICBzb2xkT3V0VGltZTogdGV4dChcInNvbGRfb3V0X3RpbWVcIiksIC8vIEhIOm1tIGZvcm1hdFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcChcImNyZWF0ZWRfYXRcIikubm90TnVsbCgpLmRlZmF1bHROb3coKSxcbiAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoXCJ1cGRhdGVkX2F0XCIpLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXG59KTtcblxuZXhwb3J0IGNvbnN0IGluc2VydFNhbGVzU2NoZW1hID0gY3JlYXRlSW5zZXJ0U2NoZW1hKHNhbGVzKS5vbWl0KHtcbiAgaWQ6IHRydWUsXG4gIGNyZWF0ZWRBdDogdHJ1ZSxcbiAgdXBkYXRlZEF0OiB0cnVlLFxufSkuZXh0ZW5kKHtcbiAgY2FzaDogei5udW1iZXIoKS5taW4oMCwgXCJDYXNoIGhhcnVzID49IDBcIiksXG4gIHFyaXM6IHoubnVtYmVyKCkubWluKDAsIFwiUVJJUyBoYXJ1cyA+PSAwXCIpLFxuICBncmFiOiB6Lm51bWJlcigpLm1pbigwLCBcIkdyYWIgaGFydXMgPj0gMFwiKSxcbiAgZ29mb29kOiB6Lm51bWJlcigpLm1pbigwLCBcIkdvRm9vZCBoYXJ1cyA+PSAwXCIpLFxuICBzaG9wZWU6IHoubnVtYmVyKCkubWluKDAsIFwiU2hvcGVlIGhhcnVzID49IDBcIiksXG4gIHRpa3Rvazogei5udW1iZXIoKS5taW4oMCwgXCJUaWtUb2sgaGFydXMgPj0gMFwiKSxcbiAgdG90YWxTb2xkOiB6Lm51bWJlcigpLmludCgpLm1pbigwLCBcIlRvdGFsIHRlcmp1YWwgaGFydXMgPj0gMFwiKSxcbiAgcmVtYWluaW5nOiB6Lm51bWJlcigpLmludCgpLm1pbigwLCBcIlNpc2EgaGFydXMgPj0gMFwiKSxcbiAgcmV0dXJuZWQ6IHoubnVtYmVyKCkuaW50KCkubWluKDAsIFwiUmV0dXJuIGhhcnVzID49IDBcIiksXG4gIHRvdGFsUHJvZHVjdGlvbjogei5udW1iZXIoKS5pbnQoKS5taW4oMCwgXCJUb3RhbCBwcm9kdWtzaSBoYXJ1cyA+PSAwXCIpLFxufSk7XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVTYWxlc1NjaGVtYSA9IGluc2VydFNhbGVzU2NoZW1hLnBhcnRpYWwoKTtcblxuZXhwb3J0IHR5cGUgSW5zZXJ0U2FsZXMgPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRTYWxlc1NjaGVtYT47XG5leHBvcnQgdHlwZSBTYWxlcyA9IHR5cGVvZiBzYWxlcy4kaW5mZXJTZWxlY3Q7XG5cbi8vIENhbGN1bGF0ZWQgdHlwZXMgZm9yIGRhc2hib2FyZFxuZXhwb3J0IHR5cGUgU2FsZXNXaXRoQ2FsY3VsYXRpb25zID0gU2FsZXMgJiB7XG4gIHRvdGFsUmV2ZW51ZTogbnVtYmVyO1xuICBjb2dzU29sZDogbnVtYmVyO1xuICBncm9zc01hcmdpbjogbnVtYmVyO1xuICBncm9zc01hcmdpblBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgb3V0bGV0TmFtZT86IHN0cmluZztcbiAgY29nc1BlclBpZWNlPzogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgRGFpbHlTdW1tYXJ5ID0ge1xuICBkYXRlOiBzdHJpbmc7XG4gIG91dGxldElkOiBzdHJpbmc7XG4gIG91dGxldE5hbWU6IHN0cmluZztcbiAgdG90YWxSZXZlbnVlOiBudW1iZXI7XG4gIHRvdGFsU29sZDogbnVtYmVyO1xuICBjb2dzU29sZDogbnVtYmVyO1xuICBncm9zc01hcmdpbjogbnVtYmVyO1xuICBncm9zc01hcmdpblBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgc29sZE91dFRpbWU/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBNVERTdW1tYXJ5ID0ge1xuICBvdXRsZXRJZDogc3RyaW5nO1xuICBvdXRsZXROYW1lOiBzdHJpbmc7XG4gIHRvdGFsUmV2ZW51ZTogbnVtYmVyO1xuICB0b3RhbFNvbGQ6IG51bWJlcjtcbiAgdG90YWxHcm9zc01hcmdpbjogbnVtYmVyO1xuICBhdmdHcm9zc01hcmdpblBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgZGFpbHlTYWxlczogQXJyYXk8e1xuICAgIGRhdGU6IHN0cmluZztcbiAgICByZXZlbnVlOiBudW1iZXI7XG4gICAgZ3Jvc3NNYXJnaW46IG51bWJlcjtcbiAgICB1bml0c1NvbGQ6IG51bWJlcjtcbiAgfT47XG59O1xuXG5leHBvcnQgdHlwZSBPdXRsZXRSYW5raW5nID0ge1xuICBvdXRsZXRJZDogc3RyaW5nO1xuICBvdXRsZXROYW1lOiBzdHJpbmc7XG4gIHRvdGFsUmV2ZW51ZTogbnVtYmVyO1xuICB0b3RhbEdyb3NzTWFyZ2luOiBudW1iZXI7XG4gIHRvdGFsU29sZDogbnVtYmVyO1xuICByYW5rOiBudW1iZXI7XG59O1xuXG4vLyBFeHBlbnNlcyB0eXBlIGVudW1cbi8vIFwiZ2FqaVwiIHR5cGUgaXMgb25seSB2aXNpYmxlIHRvIG93bmVyIHJvbGVcbmV4cG9ydCB0eXBlIEV4cGVuc2VUeXBlID0gXCJoYXJpYW5cIiB8IFwiYnVsYW5hblwiIHwgXCJnYWppXCI7XG5cbi8vIEV4cGVuc2VzIHRhYmxlXG5leHBvcnQgY29uc3QgZXhwZW5zZXMgPSBwZ1RhYmxlKFwiZXhwZW5zZXNcIiwge1xuICBpZDogdmFyY2hhcihcImlkXCIpLnByaW1hcnlLZXkoKS5kZWZhdWx0KHNxbGBnZW5fcmFuZG9tX3V1aWQoKWApLFxuICBvdXRsZXRJZDogdmFyY2hhcihcIm91dGxldF9pZFwiKS5ub3ROdWxsKCksXG4gIGRhdGU6IHRleHQoXCJkYXRlXCIpLm5vdE51bGwoKSwgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgdHlwZTogdmFyY2hhcihcInR5cGVcIikuJHR5cGU8RXhwZW5zZVR5cGU+KCkubm90TnVsbCgpLCAvLyBcImhhcmlhblwiIGF0YXUgXCJidWxhbmFuXCJcbiAgZGVzY3JpcHRpb246IHRleHQoXCJkZXNjcmlwdGlvblwiKS5ub3ROdWxsKCksXG4gIGFtb3VudDogcmVhbChcImFtb3VudFwiKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgcHJvb2ZVcmw6IHRleHQoXCJwcm9vZl91cmxcIiksIC8vIFVSTCB0byB1cGxvYWRlZCBwcm9vZiBmaWxlIChwaG90by9QREYpXG4gIGNyZWF0ZWRBdDogdGltZXN0YW1wKFwiY3JlYXRlZF9hdFwiKS5ub3ROdWxsKCkuZGVmYXVsdE5vdygpLFxuICB1cGRhdGVkQXQ6IHRpbWVzdGFtcChcInVwZGF0ZWRfYXRcIikubm90TnVsbCgpLmRlZmF1bHROb3coKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0RXhwZW5zZVNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYShleHBlbnNlcykub21pdCh7XG4gIGlkOiB0cnVlLFxuICBjcmVhdGVkQXQ6IHRydWUsXG4gIHVwZGF0ZWRBdDogdHJ1ZSxcbn0pLmV4dGVuZCh7XG4gIGFtb3VudDogei5udW1iZXIoKS5taW4oMCwgXCJKdW1sYWggaGFydXMgPj0gMFwiKSxcbiAgdHlwZTogei5lbnVtKFtcImhhcmlhblwiLCBcImJ1bGFuYW5cIiwgXCJnYWppXCJdLCB7XG4gICAgZXJyb3JNYXA6ICgpID0+ICh7IG1lc3NhZ2U6IFwiSmVuaXMgaGFydXMgJ2hhcmlhbicsICdidWxhbmFuJywgYXRhdSAnZ2FqaSdcIiB9KSxcbiAgfSksXG4gIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm1pbigxLCBcIkRlc2tyaXBzaSBoYXJ1cyBkaWlzaVwiKSxcbiAgcHJvb2ZVcmw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlRXhwZW5zZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgb3V0bGV0SWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZGF0ZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB0eXBlOiB6LmVudW0oW1wiaGFyaWFuXCIsIFwiYnVsYW5hblwiLCBcImdhamlcIl0sIHtcbiAgICBlcnJvck1hcDogKCkgPT4gKHsgbWVzc2FnZTogXCJKZW5pcyBoYXJ1cyAnaGFyaWFuJywgJ2J1bGFuYW4nLCBhdGF1ICdnYWppJ1wiIH0pLFxuICB9KS5vcHRpb25hbCgpLFxuICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5taW4oMSwgXCJEZXNrcmlwc2kgaGFydXMgZGlpc2lcIikub3B0aW9uYWwoKSxcbiAgYW1vdW50OiB6Lm51bWJlcigpLm1pbigwLCBcIkp1bWxhaCBoYXJ1cyA+PSAwXCIpLm9wdGlvbmFsKCksXG4gIHByb29mVXJsOiB6LnN0cmluZygpLm51bGxhYmxlKCkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgdHlwZSBJbnNlcnRFeHBlbnNlID0gei5pbmZlcjx0eXBlb2YgaW5zZXJ0RXhwZW5zZVNjaGVtYT47XG5leHBvcnQgdHlwZSBFeHBlbnNlID0gdHlwZW9mIGV4cGVuc2VzLiRpbmZlclNlbGVjdDtcblxuLy8gRXhwZW5zZSB3aXRoIG91dGxldCBuYW1lIGZvciBkaXNwbGF5XG5leHBvcnQgdHlwZSBFeHBlbnNlV2l0aE91dGxldCA9IEV4cGVuc2UgJiB7XG4gIG91dGxldE5hbWU/OiBzdHJpbmc7XG59O1xuIl0sIm5hbWVzIjpbInNxbCIsInBnVGFibGUiLCJ0ZXh0IiwidmFyY2hhciIsImludGVnZXIiLCJyZWFsIiwidGltZXN0YW1wIiwianNvbmIiLCJpbmRleCIsImNyZWF0ZUluc2VydFNjaGVtYSIsInoiLCJzZXNzaW9ucyIsInNpZCIsInByaW1hcnlLZXkiLCJzZXNzIiwibm90TnVsbCIsImV4cGlyZSIsInRhYmxlIiwib24iLCJ1c2VycyIsImlkIiwiZGVmYXVsdCIsImVtYWlsIiwidW5pcXVlIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJwcm9maWxlSW1hZ2VVcmwiLCJyb2xlIiwiJHR5cGUiLCJwYXNzd29yZCIsImFzc2lnbmVkT3V0bGV0SWQiLCJjcmVhdGVkQXQiLCJkZWZhdWx0Tm93IiwidXBkYXRlZEF0IiwiaW5zZXJ0QWRtaW5TY2hlbWEiLCJvYmplY3QiLCJzdHJpbmciLCJtaW4iLCJvcHRpb25hbCIsImVudW0iLCJlcnJvck1hcCIsIm1lc3NhZ2UiLCJvdXRsZXRzIiwibmFtZSIsImNvZ3NQZXJQaWVjZSIsImluc2VydE91dGxldFNjaGVtYSIsIm9taXQiLCJzYWxlcyIsIm91dGxldElkIiwiZGF0ZSIsImNhc2giLCJxcmlzIiwiZ3JhYiIsImdvZm9vZCIsInNob3BlZSIsInRpa3RvayIsInRvdGFsU29sZCIsInJlbWFpbmluZyIsInJldHVybmVkIiwidG90YWxQcm9kdWN0aW9uIiwic29sZE91dFRpbWUiLCJpbnNlcnRTYWxlc1NjaGVtYSIsImV4dGVuZCIsIm51bWJlciIsImludCIsInVwZGF0ZVNhbGVzU2NoZW1hIiwicGFydGlhbCIsImV4cGVuc2VzIiwidHlwZSIsImRlc2NyaXB0aW9uIiwiYW1vdW50IiwicHJvb2ZVcmwiLCJpbnNlcnRFeHBlbnNlU2NoZW1hIiwidXBkYXRlRXhwZW5zZVNjaGVtYSIsIm51bGxhYmxlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./shared/schema.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/db.ts":
/*!**********************!*\
  !*** ./src/db/db.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   pool: () => (/* binding */ pool)\n/* harmony export */ });\n/* harmony import */ var _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @neondatabase/serverless */ \"(rsc)/./node_modules/@neondatabase/serverless/index.mjs\");\n/* harmony import */ var drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/neon-serverless */ \"(rsc)/./node_modules/drizzle-orm/neon-serverless/driver.js\");\n/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ws */ \"(rsc)/./node_modules/ws/wrapper.mjs\");\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @shared/schema */ \"(rsc)/./shared/schema.ts\");\n\n\n\n\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.webSocketConstructor = ws__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\nif (!process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL must be set. Did you forget to provision a database?\");\n}\nconst pool = new _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.Pool({\n    connectionString: process.env.DATABASE_URL\n});\nconst db = (0,drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_3__.drizzle)({\n    client: pool,\n    schema: _shared_schema__WEBPACK_IMPORTED_MODULE_2__\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZGIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTREO0FBQ047QUFDbEM7QUFDcUI7QUFFekNDLGdFQUFVQSxDQUFDSSxvQkFBb0IsR0FBR0YsMENBQUVBO0FBRXBDLElBQUksQ0FBQ0csUUFBUUMsR0FBRyxDQUFDQyxZQUFZLEVBQUU7SUFDN0IsTUFBTSxJQUFJQyxNQUNSO0FBRUo7QUFFTyxNQUFNQyxPQUFPLElBQUlWLDBEQUFJQSxDQUFDO0lBQUVXLGtCQUFrQkwsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0FBQUMsR0FBRztBQUN0RSxNQUFNSSxLQUFLVixvRUFBT0EsQ0FBQztJQUFFVyxRQUFRSDtJQUFNTixNQUFNQSw2Q0FBQUE7QUFBQyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc3JjL2RiL2RiLnRzPzkyY2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9vbCwgbmVvbkNvbmZpZyB9IGZyb20gJ0BuZW9uZGF0YWJhc2Uvc2VydmVybGVzcyc7XG5pbXBvcnQgeyBkcml6emxlIH0gZnJvbSAnZHJpenpsZS1vcm0vbmVvbi1zZXJ2ZXJsZXNzJztcbmltcG9ydCB3cyBmcm9tIFwid3NcIjtcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcblxubmVvbkNvbmZpZy53ZWJTb2NrZXRDb25zdHJ1Y3RvciA9IHdzO1xuXG5pZiAoIXByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgXCJEQVRBQkFTRV9VUkwgbXVzdCBiZSBzZXQuIERpZCB5b3UgZm9yZ2V0IHRvIHByb3Zpc2lvbiBhIGRhdGFiYXNlP1wiLFxuICApO1xufVxuXG5leHBvcnQgY29uc3QgcG9vbCA9IG5ldyBQb29sKHsgY29ubmVjdGlvblN0cmluZzogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMIH0pO1xuZXhwb3J0IGNvbnN0IGRiID0gZHJpenpsZSh7IGNsaWVudDogcG9vbCwgc2NoZW1hIH0pO1xuIl0sIm5hbWVzIjpbIlBvb2wiLCJuZW9uQ29uZmlnIiwiZHJpenpsZSIsIndzIiwic2NoZW1hIiwid2ViU29ja2V0Q29uc3RydWN0b3IiLCJwcm9jZXNzIiwiZW52IiwiREFUQUJBU0VfVVJMIiwiRXJyb3IiLCJwb29sIiwiY29ubmVjdGlvblN0cmluZyIsImRiIiwiY2xpZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/db/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/storage.ts":
/*!***************************!*\
  !*** ./src/db/storage.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseStorage: () => (/* binding */ DatabaseStorage),\n/* harmony export */   storage: () => (/* binding */ storage)\n/* harmony export */ });\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @shared/schema */ \"(rsc)/./shared/schema.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db */ \"(rsc)/./src/db/db.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n\n\n\nclass DatabaseStorage {\n    // User operations - Required for Replit Auth\n    async getUser(id) {\n        const [user] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.id, id));\n        return user;\n    }\n    async getUserByEmail(email) {\n        const [user] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.email, email));\n        return user;\n    }\n    async upsertUser(userData) {\n        const [user] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).values(userData).onConflictDoUpdate({\n            target: _shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.id,\n            set: {\n                ...userData,\n                updatedAt: new Date()\n            }\n        }).returning();\n        return user;\n    }\n    // Admin management operations (for SUPER_ADMIN)\n    async getAdminUsers() {\n        // Get all users that have a password (created by SUPER_ADMIN) and are not SUPER_ADMIN\n        const adminUsers = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.isNotNull)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.password), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.ne)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.role, \"super_admin\")));\n        return adminUsers.sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n    }\n    async createAdminUser(data) {\n        const [user] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).values({\n            email: data.email,\n            firstName: data.firstName,\n            lastName: data.lastName || null,\n            password: data.password,\n            role: data.role,\n            assignedOutletId: data.assignedOutletId || null\n        }).returning();\n        return user;\n    }\n    async deleteAdminUser(id) {\n        const result = await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.id, id));\n        return result.rowCount !== null && result.rowCount > 0;\n    }\n    async getOutlets() {\n        return await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets);\n    }\n    async getOutlet(id) {\n        const [outlet] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets.id, id));\n        return outlet || undefined;\n    }\n    async createOutlet(insertOutlet) {\n        const [outlet] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets).values(insertOutlet).returning();\n        return outlet;\n    }\n    async updateOutlet(id, insertOutlet) {\n        const [outlet] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.update(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets).set(insertOutlet).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets.id, id)).returning();\n        return outlet || undefined;\n    }\n    async deleteOutlet(id) {\n        // First delete all related sales and expenses (cascade delete)\n        await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.outletId, id));\n        await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.outletId, id));\n        // Then delete the outlet\n        const result = await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.outlets.id, id));\n        return result.rowCount !== null && result.rowCount > 0;\n    }\n    // Delete all sales for an outlet\n    async deleteSalesByOutlet(outletId) {\n        const result = await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.outletId, outletId));\n        return result.rowCount || 0;\n    }\n    // Get MTD expenses for calculating profit/loss\n    async getMTDExpenses(date, outletId) {\n        const currentDate = new Date(date);\n        const { start, end } = this.getMTDPeriod(currentDate);\n        const startDateStr = start.toISOString().split(\"T\")[0];\n        const endDateStr = end.toISOString().split(\"T\")[0];\n        const conditions = [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.gte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.date, startDateStr),\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.lte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.date, endDateStr)\n        ];\n        if (outletId) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.outletId, outletId));\n        }\n        const mtdExpenses = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)(...conditions));\n        const daily = mtdExpenses.filter((e)=>e.type === \"harian\").reduce((sum, e)=>sum + e.amount, 0);\n        const monthly = mtdExpenses.filter((e)=>e.type === \"bulanan\").reduce((sum, e)=>sum + e.amount, 0);\n        return {\n            daily,\n            monthly\n        };\n    }\n    // Get outlet summary for a specific MTD period\n    async getOutletMTDSummary(outletId, date) {\n        const currentDate = new Date(date);\n        const { start, end } = this.getMTDPeriod(currentDate);\n        const mtdSales = await this.getMTDSales(date, outletId);\n        const mtdExpenses = await this.getMTDExpenses(date, outletId);\n        const totalSold = mtdSales.reduce((sum, s)=>sum + s.totalSold, 0);\n        const totalRevenue = mtdSales.reduce((sum, s)=>sum + s.totalRevenue, 0);\n        const totalCogs = mtdSales.reduce((sum, s)=>sum + s.cogsSold, 0);\n        const netProfit = totalRevenue - totalCogs - mtdExpenses.daily - mtdExpenses.monthly;\n        return {\n            totalSold,\n            totalRevenue,\n            totalCogs,\n            totalDailyExpenses: mtdExpenses.daily,\n            totalMonthlyExpenses: mtdExpenses.monthly,\n            netProfit,\n            periodStart: start.toISOString().split(\"T\")[0],\n            periodEnd: end.toISOString().split(\"T\")[0]\n        };\n    }\n    async getSales(filters) {\n        let query = _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales);\n        const conditions = [];\n        if (filters?.date) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.date, filters.date));\n        }\n        if (filters?.outletId) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.outletId, filters.outletId));\n        }\n        if (conditions.length > 0) {\n            query = query.where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)(...conditions));\n        }\n        const result = await query;\n        return result.sort((a, b)=>new Date(b.date).getTime() - new Date(a.date).getTime());\n    }\n    async getSalesById(id) {\n        const [sale] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.id, id));\n        return sale || undefined;\n    }\n    async createSales(insertSales) {\n        const [sale] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).values(insertSales).returning();\n        return sale;\n    }\n    async updateSales(id, updateData) {\n        const [sale] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.update(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).set({\n            ...updateData,\n            updatedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.id, id)).returning();\n        return sale || undefined;\n    }\n    async deleteSales(id) {\n        const result = await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.id, id));\n        return result.rowCount !== null && result.rowCount > 0;\n    }\n    calculateSalesMetrics(sale, outlet) {\n        const totalRevenue = sale.cash + sale.qris + sale.grab + sale.gofood + sale.shopee + sale.tiktok;\n        const cogsPerPiece = outlet?.cogsPerPiece || 0;\n        const cogsSold = sale.totalSold * cogsPerPiece;\n        const grossMargin = totalRevenue - cogsSold;\n        const grossMarginPercentage = totalRevenue > 0 ? grossMargin / totalRevenue * 100 : 0;\n        return {\n            ...sale,\n            totalRevenue,\n            cogsSold,\n            grossMargin,\n            grossMarginPercentage,\n            outletName: outlet?.name,\n            cogsPerPiece\n        };\n    }\n    async getSalesWithCalculations(filters) {\n        const salesData = await this.getSales(filters);\n        const outletsData = await this.getOutlets();\n        const outletMap = new Map(outletsData.map((o)=>[\n                o.id,\n                o\n            ]));\n        return salesData.map((sale)=>this.calculateSalesMetrics(sale, outletMap.get(sale.outletId)));\n    }\n    getMTDPeriod(date) {\n        const day = date.getDate();\n        const month = date.getMonth();\n        const year = date.getFullYear();\n        if (day >= 10) {\n            const start = new Date(year, month, 10);\n            const end = new Date(year, month + 1, 9);\n            end.setHours(23, 59, 59, 999);\n            return {\n                start,\n                end\n            };\n        } else {\n            const start = new Date(year, month - 1, 10);\n            const end = new Date(year, month, 9);\n            end.setHours(23, 59, 59, 999);\n            return {\n                start,\n                end\n            };\n        }\n    }\n    async getMTDSales(date, outletId) {\n        const currentDate = new Date(date);\n        const { start, end } = this.getMTDPeriod(currentDate);\n        const startDateStr = start.toISOString().split(\"T\")[0];\n        const endDateStr = end.toISOString().split(\"T\")[0];\n        const conditions = [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.gte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.date, startDateStr),\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.lte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.date, endDateStr)\n        ];\n        if (outletId) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.outletId, outletId));\n        }\n        const mtdSales = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)(...conditions));\n        const outletsData = await this.getOutlets();\n        const outletMap = new Map(outletsData.map((o)=>[\n                o.id,\n                o\n            ]));\n        return mtdSales.map((sale)=>this.calculateSalesMetrics(sale, outletMap.get(sale.outletId))).sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n    }\n    async getMTDSummary(date) {\n        const currentDate = new Date(date);\n        const { start, end } = this.getMTDPeriod(currentDate);\n        const startDateStr = start.toISOString().split(\"T\")[0];\n        const endDateStr = end.toISOString().split(\"T\")[0];\n        const outletsData = await this.getOutlets();\n        const mtdSales = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.gte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.date, startDateStr), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.lte)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.sales.date, endDateStr)));\n        const outletMap = new Map(outletsData.map((o)=>[\n                o.id,\n                o\n            ]));\n        const summaryMap = new Map();\n        for (const outlet of outletsData){\n            const outletSales = mtdSales.filter((s)=>s.outletId === outlet.id);\n            const dailySales = outletSales.map((sale)=>{\n                const metrics = this.calculateSalesMetrics(sale, outlet);\n                return {\n                    date: sale.date,\n                    revenue: metrics.totalRevenue,\n                    grossMargin: metrics.grossMargin,\n                    unitsSold: sale.totalSold\n                };\n            });\n            const totalRevenue = dailySales.reduce((sum, d)=>sum + d.revenue, 0);\n            const totalGrossMargin = dailySales.reduce((sum, d)=>sum + d.grossMargin, 0);\n            const totalSold = dailySales.reduce((sum, d)=>sum + d.unitsSold, 0);\n            const avgGrossMarginPercentage = totalRevenue > 0 ? totalGrossMargin / totalRevenue * 100 : 0;\n            summaryMap.set(outlet.id, {\n                outletId: outlet.id,\n                outletName: outlet.name,\n                totalRevenue,\n                totalSold,\n                totalGrossMargin,\n                avgGrossMarginPercentage,\n                dailySales\n            });\n        }\n        return Array.from(summaryMap.values()).sort((a, b)=>b.totalGrossMargin - a.totalGrossMargin);\n    }\n    // Expense operations\n    async getExpenses(filters) {\n        let query = _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses);\n        const conditions = [];\n        if (filters?.date) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.date, filters.date));\n        }\n        if (filters?.outletId) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.outletId, filters.outletId));\n        }\n        if (filters?.type) {\n            conditions.push((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.type, filters.type));\n        }\n        if (conditions.length > 0) {\n            query = query.where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)(...conditions));\n        }\n        const result = await query;\n        return result.sort((a, b)=>new Date(b.date).getTime() - new Date(a.date).getTime());\n    }\n    async getExpenseById(id) {\n        const [expense] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.id, id));\n        return expense || undefined;\n    }\n    async createExpense(insertExpense) {\n        const [expense] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).values(insertExpense).returning();\n        return expense;\n    }\n    async updateExpense(id, insertExpense) {\n        const [expense] = await _db__WEBPACK_IMPORTED_MODULE_1__.db.update(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).set({\n            ...insertExpense,\n            updatedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.id, id)).returning();\n        return expense || undefined;\n    }\n    async deleteExpense(id) {\n        const result = await _db__WEBPACK_IMPORTED_MODULE_1__.db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.expenses.id, id));\n        return result.rowCount !== null && result.rowCount > 0;\n    }\n    async getExpensesWithOutlet(filters) {\n        const expensesData = await this.getExpenses(filters);\n        const outletsData = await this.getOutlets();\n        const outletMap = new Map(outletsData.map((o)=>[\n                o.id,\n                o\n            ]));\n        return expensesData.map((expense)=>({\n                ...expense,\n                outletName: outletMap.get(expense.outletId)?.name\n            }));\n    }\n}\nconst storage = new DatabaseStorage();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0JBQXNCdkQsT0FJM0IsRUFBZ0M7UUFDL0IsTUFBTXdELGVBQWUsTUFBTSxJQUFJLENBQUNSLFdBQVcsQ0FBQ2hEO1FBQzVDLE1BQU13QixjQUFjLE1BQU0sSUFBSSxDQUFDdEUsVUFBVTtRQUV6QyxNQUFNdUUsWUFBWSxJQUFJQyxJQUFJRixZQUFZRyxHQUFHLENBQUMsQ0FBQ0MsSUFBTTtnQkFBQ0EsRUFBRTdHLEVBQUU7Z0JBQUU2RzthQUFFO1FBRTFELE9BQU80QixhQUFhN0IsR0FBRyxDQUFDLENBQUN1QixVQUFhO2dCQUNwQyxHQUFHQSxPQUFPO2dCQUNWOUIsWUFBWUssVUFBVUksR0FBRyxDQUFDcUIsUUFBUXZGLFFBQVEsR0FBRzBEO1lBQy9DO0lBQ0Y7QUFDRjtBQUVPLE1BQU1vQyxVQUFVLElBQUk1SSxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZXN0LWV4cHJlc3MvLi9zcmMvZGIvc3RvcmFnZS50cz81MWNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIHR5cGUgT3V0bGV0LFxuICB0eXBlIEluc2VydE91dGxldCxcbiAgdHlwZSBTYWxlcyxcbiAgdHlwZSBJbnNlcnRTYWxlcyxcbiAgdHlwZSBTYWxlc1dpdGhDYWxjdWxhdGlvbnMsXG4gIHR5cGUgTVREU3VtbWFyeSxcbiAgdHlwZSBVc2VyLFxuICB0eXBlIFVwc2VydFVzZXIsXG4gIHR5cGUgVXNlclJvbGUsXG4gIHR5cGUgRXhwZW5zZSxcbiAgdHlwZSBJbnNlcnRFeHBlbnNlLFxuICB0eXBlIEV4cGVuc2VXaXRoT3V0bGV0LFxuICBvdXRsZXRzLFxuICBzYWxlcyxcbiAgdXNlcnMsXG4gIGV4cGVuc2VzLFxufSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcbmltcG9ydCB7IGRiIH0gZnJvbSBcIi4vZGJcIjtcbmltcG9ydCB7IGVxLCBhbmQsIGd0ZSwgbHRlLCBuZSwgaXNOb3ROdWxsIH0gZnJvbSBcImRyaXp6bGUtb3JtXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVN0b3JhZ2Uge1xuICAvLyBVc2VyIG9wZXJhdGlvbnMgLSBSZXF1aXJlZCBmb3IgUmVwbGl0IEF1dGhcbiAgZ2V0VXNlcihpZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPjtcbiAgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD47XG4gIHVwc2VydFVzZXIodXNlcjogVXBzZXJ0VXNlcik6IFByb21pc2U8VXNlcj47XG4gIFxuICAvLyBBZG1pbiBtYW5hZ2VtZW50IG9wZXJhdGlvbnMgKGZvciBTVVBFUl9BRE1JTilcbiAgZ2V0QWRtaW5Vc2VycygpOiBQcm9taXNlPFVzZXJbXT47XG4gIGNyZWF0ZUFkbWluVXNlcihkYXRhOiB7XG4gICAgZW1haWw6IHN0cmluZztcbiAgICBmaXJzdE5hbWU6IHN0cmluZztcbiAgICBsYXN0TmFtZT86IHN0cmluZztcbiAgICBwYXNzd29yZDogc3RyaW5nOyAvLyBBbHJlYWR5IGhhc2hlZFxuICAgIHJvbGU6IFVzZXJSb2xlO1xuICAgIGFzc2lnbmVkT3V0bGV0SWQ/OiBzdHJpbmc7XG4gIH0pOiBQcm9taXNlPFVzZXI+O1xuICBkZWxldGVBZG1pblVzZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG5cbiAgZ2V0T3V0bGV0cygpOiBQcm9taXNlPE91dGxldFtdPjtcbiAgZ2V0T3V0bGV0KGlkOiBzdHJpbmcpOiBQcm9taXNlPE91dGxldCB8IHVuZGVmaW5lZD47XG4gIGNyZWF0ZU91dGxldChvdXRsZXQ6IEluc2VydE91dGxldCk6IFByb21pc2U8T3V0bGV0PjtcbiAgdXBkYXRlT3V0bGV0KGlkOiBzdHJpbmcsIG91dGxldDogSW5zZXJ0T3V0bGV0KTogUHJvbWlzZTxPdXRsZXQgfCB1bmRlZmluZWQ+O1xuICBkZWxldGVPdXRsZXQoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG5cbiAgZ2V0U2FsZXMoZmlsdGVycz86IHsgZGF0ZT86IHN0cmluZzsgb3V0bGV0SWQ/OiBzdHJpbmcgfSk6IFByb21pc2U8U2FsZXNbXT47XG4gIGdldFNhbGVzQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTYWxlcyB8IHVuZGVmaW5lZD47XG4gIGNyZWF0ZVNhbGVzKHNhbGVzOiBJbnNlcnRTYWxlcyk6IFByb21pc2U8U2FsZXM+O1xuICB1cGRhdGVTYWxlcyhpZDogc3RyaW5nLCBzYWxlczogUGFydGlhbDxJbnNlcnRTYWxlcz4pOiBQcm9taXNlPFNhbGVzIHwgdW5kZWZpbmVkPjtcbiAgZGVsZXRlU2FsZXMoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG4gIGRlbGV0ZVNhbGVzQnlPdXRsZXQob3V0bGV0SWQ6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPjtcblxuICBnZXRTYWxlc1dpdGhDYWxjdWxhdGlvbnMoZmlsdGVycz86IHtcbiAgICBkYXRlPzogc3RyaW5nO1xuICAgIG91dGxldElkPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxTYWxlc1dpdGhDYWxjdWxhdGlvbnNbXT47XG5cbiAgZ2V0TVREU2FsZXMoZGF0ZTogc3RyaW5nLCBvdXRsZXRJZD86IHN0cmluZyk6IFByb21pc2U8U2FsZXNXaXRoQ2FsY3VsYXRpb25zW10+O1xuICBnZXRNVERTdW1tYXJ5KGRhdGU6IHN0cmluZyk6IFByb21pc2U8TVREU3VtbWFyeVtdPjtcbiAgZ2V0TVRERXhwZW5zZXMoZGF0ZTogc3RyaW5nLCBvdXRsZXRJZD86IHN0cmluZyk6IFByb21pc2U8eyBkYWlseTogbnVtYmVyOyBtb250aGx5OiBudW1iZXIgfT47XG4gIGdldE91dGxldE1URFN1bW1hcnkob3V0bGV0SWQ6IHN0cmluZywgZGF0ZTogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgdG90YWxTb2xkOiBudW1iZXI7XG4gICAgdG90YWxSZXZlbnVlOiBudW1iZXI7XG4gICAgdG90YWxDb2dzOiBudW1iZXI7XG4gICAgdG90YWxEYWlseUV4cGVuc2VzOiBudW1iZXI7XG4gICAgdG90YWxNb250aGx5RXhwZW5zZXM6IG51bWJlcjtcbiAgICBuZXRQcm9maXQ6IG51bWJlcjtcbiAgICBwZXJpb2RTdGFydDogc3RyaW5nO1xuICAgIHBlcmlvZEVuZDogc3RyaW5nO1xuICB9PjtcblxuICAvLyBFeHBlbnNlIG9wZXJhdGlvbnNcbiAgZ2V0RXhwZW5zZXMoZmlsdGVycz86IHsgZGF0ZT86IHN0cmluZzsgb3V0bGV0SWQ/OiBzdHJpbmc7IHR5cGU/OiBcImhhcmlhblwiIHwgXCJidWxhbmFuXCIgfSk6IFByb21pc2U8RXhwZW5zZVtdPjtcbiAgZ2V0RXhwZW5zZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RXhwZW5zZSB8IHVuZGVmaW5lZD47XG4gIGNyZWF0ZUV4cGVuc2UoZXhwZW5zZTogSW5zZXJ0RXhwZW5zZSk6IFByb21pc2U8RXhwZW5zZT47XG4gIHVwZGF0ZUV4cGVuc2UoaWQ6IHN0cmluZywgZXhwZW5zZTogUGFydGlhbDxJbnNlcnRFeHBlbnNlPik6IFByb21pc2U8RXhwZW5zZSB8IHVuZGVmaW5lZD47XG4gIGRlbGV0ZUV4cGVuc2UoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG4gIGdldEV4cGVuc2VzV2l0aE91dGxldChmaWx0ZXJzPzogeyBkYXRlPzogc3RyaW5nOyBvdXRsZXRJZD86IHN0cmluZzsgdHlwZT86IFwiaGFyaWFuXCIgfCBcImJ1bGFuYW5cIiB9KTogUHJvbWlzZTxFeHBlbnNlV2l0aE91dGxldFtdPjtcbn1cblxuZXhwb3J0IGNsYXNzIERhdGFiYXNlU3RvcmFnZSBpbXBsZW1lbnRzIElTdG9yYWdlIHtcbiAgLy8gVXNlciBvcGVyYXRpb25zIC0gUmVxdWlyZWQgZm9yIFJlcGxpdCBBdXRoXG4gIGFzeW5jIGdldFVzZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD4ge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20odXNlcnMpLndoZXJlKGVxKHVzZXJzLmlkLCBpZCkpO1xuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD4ge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20odXNlcnMpLndoZXJlKGVxKHVzZXJzLmVtYWlsLCBlbWFpbCkpO1xuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgYXN5bmMgdXBzZXJ0VXNlcih1c2VyRGF0YTogVXBzZXJ0VXNlcik6IFByb21pc2U8VXNlcj4ge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiXG4gICAgICAuaW5zZXJ0KHVzZXJzKVxuICAgICAgLnZhbHVlcyh1c2VyRGF0YSlcbiAgICAgIC5vbkNvbmZsaWN0RG9VcGRhdGUoe1xuICAgICAgICB0YXJnZXQ6IHVzZXJzLmlkLFxuICAgICAgICBzZXQ6IHtcbiAgICAgICAgICAuLi51c2VyRGF0YSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICAgLnJldHVybmluZygpO1xuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgLy8gQWRtaW4gbWFuYWdlbWVudCBvcGVyYXRpb25zIChmb3IgU1VQRVJfQURNSU4pXG4gIGFzeW5jIGdldEFkbWluVXNlcnMoKTogUHJvbWlzZTxVc2VyW10+IHtcbiAgICAvLyBHZXQgYWxsIHVzZXJzIHRoYXQgaGF2ZSBhIHBhc3N3b3JkIChjcmVhdGVkIGJ5IFNVUEVSX0FETUlOKSBhbmQgYXJlIG5vdCBTVVBFUl9BRE1JTlxuICAgIGNvbnN0IGFkbWluVXNlcnMgPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbSh1c2VycylcbiAgICAgIC53aGVyZShhbmQoXG4gICAgICAgIGlzTm90TnVsbCh1c2Vycy5wYXNzd29yZCksXG4gICAgICAgIG5lKHVzZXJzLnJvbGUsIFwic3VwZXJfYWRtaW5cIilcbiAgICAgICkpO1xuICAgIHJldHVybiBhZG1pblVzZXJzLnNvcnQoKGEsIGIpID0+IFxuICAgICAgbmV3IERhdGUoYi5jcmVhdGVkQXQhKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmNyZWF0ZWRBdCEpLmdldFRpbWUoKVxuICAgICk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVBZG1pblVzZXIoZGF0YToge1xuICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgZmlyc3ROYW1lOiBzdHJpbmc7XG4gICAgbGFzdE5hbWU/OiBzdHJpbmc7XG4gICAgcGFzc3dvcmQ6IHN0cmluZztcbiAgICByb2xlOiBVc2VyUm9sZTtcbiAgICBhc3NpZ25lZE91dGxldElkPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxVc2VyPiB7XG4gICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGJcbiAgICAgIC5pbnNlcnQodXNlcnMpXG4gICAgICAudmFsdWVzKHtcbiAgICAgICAgZW1haWw6IGRhdGEuZW1haWwsXG4gICAgICAgIGZpcnN0TmFtZTogZGF0YS5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiBkYXRhLmxhc3ROYW1lIHx8IG51bGwsXG4gICAgICAgIHBhc3N3b3JkOiBkYXRhLnBhc3N3b3JkLFxuICAgICAgICByb2xlOiBkYXRhLnJvbGUsXG4gICAgICAgIGFzc2lnbmVkT3V0bGV0SWQ6IGRhdGEuYXNzaWduZWRPdXRsZXRJZCB8fCBudWxsLFxuICAgICAgfSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICByZXR1cm4gdXNlcjtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUFkbWluVXNlcihpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZGVsZXRlKHVzZXJzKS53aGVyZShlcSh1c2Vycy5pZCwgaWQpKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ICE9PSBudWxsICYmIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICBhc3luYyBnZXRPdXRsZXRzKCk6IFByb21pc2U8T3V0bGV0W10+IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShvdXRsZXRzKTtcbiAgfVxuXG4gIGFzeW5jIGdldE91dGxldChpZDogc3RyaW5nKTogUHJvbWlzZTxPdXRsZXQgfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCBbb3V0bGV0XSA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20ob3V0bGV0cykud2hlcmUoZXEob3V0bGV0cy5pZCwgaWQpKTtcbiAgICByZXR1cm4gb3V0bGV0IHx8IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZU91dGxldChpbnNlcnRPdXRsZXQ6IEluc2VydE91dGxldCk6IFByb21pc2U8T3V0bGV0PiB7XG4gICAgY29uc3QgW291dGxldF0gPSBhd2FpdCBkYlxuICAgICAgLmluc2VydChvdXRsZXRzKVxuICAgICAgLnZhbHVlcyhpbnNlcnRPdXRsZXQpXG4gICAgICAucmV0dXJuaW5nKCk7XG4gICAgcmV0dXJuIG91dGxldDtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZU91dGxldChcbiAgICBpZDogc3RyaW5nLFxuICAgIGluc2VydE91dGxldDogSW5zZXJ0T3V0bGV0XG4gICk6IFByb21pc2U8T3V0bGV0IHwgdW5kZWZpbmVkPiB7XG4gICAgY29uc3QgW291dGxldF0gPSBhd2FpdCBkYlxuICAgICAgLnVwZGF0ZShvdXRsZXRzKVxuICAgICAgLnNldChpbnNlcnRPdXRsZXQpXG4gICAgICAud2hlcmUoZXEob3V0bGV0cy5pZCwgaWQpKVxuICAgICAgLnJldHVybmluZygpO1xuICAgIHJldHVybiBvdXRsZXQgfHwgdW5kZWZpbmVkO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlT3V0bGV0KGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBGaXJzdCBkZWxldGUgYWxsIHJlbGF0ZWQgc2FsZXMgYW5kIGV4cGVuc2VzIChjYXNjYWRlIGRlbGV0ZSlcbiAgICBhd2FpdCBkYi5kZWxldGUoc2FsZXMpLndoZXJlKGVxKHNhbGVzLm91dGxldElkLCBpZCkpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShleHBlbnNlcykud2hlcmUoZXEoZXhwZW5zZXMub3V0bGV0SWQsIGlkKSk7XG4gICAgXG4gICAgLy8gVGhlbiBkZWxldGUgdGhlIG91dGxldFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmRlbGV0ZShvdXRsZXRzKS53aGVyZShlcShvdXRsZXRzLmlkLCBpZCkpO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgIT09IG51bGwgJiYgcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vIERlbGV0ZSBhbGwgc2FsZXMgZm9yIGFuIG91dGxldFxuICBhc3luYyBkZWxldGVTYWxlc0J5T3V0bGV0KG91dGxldElkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmRlbGV0ZShzYWxlcykud2hlcmUoZXEoc2FsZXMub3V0bGV0SWQsIG91dGxldElkKSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCB8fCAwO1xuICB9XG5cbiAgLy8gR2V0IE1URCBleHBlbnNlcyBmb3IgY2FsY3VsYXRpbmcgcHJvZml0L2xvc3NcbiAgYXN5bmMgZ2V0TVRERXhwZW5zZXMoZGF0ZTogc3RyaW5nLCBvdXRsZXRJZD86IHN0cmluZyk6IFByb21pc2U8eyBkYWlseTogbnVtYmVyOyBtb250aGx5OiBudW1iZXIgfT4ge1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSB0aGlzLmdldE1URFBlcmlvZChjdXJyZW50RGF0ZSk7XG4gICAgXG4gICAgY29uc3Qgc3RhcnREYXRlU3RyID0gc3RhcnQudG9JU09TdHJpbmcoKS5zcGxpdChcIlRcIilbMF07XG4gICAgY29uc3QgZW5kRGF0ZVN0ciA9IGVuZC50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXTtcbiAgICBcbiAgICBjb25zdCBjb25kaXRpb25zID0gW1xuICAgICAgZ3RlKGV4cGVuc2VzLmRhdGUsIHN0YXJ0RGF0ZVN0ciksXG4gICAgICBsdGUoZXhwZW5zZXMuZGF0ZSwgZW5kRGF0ZVN0ciksXG4gICAgXTtcbiAgICBcbiAgICBpZiAob3V0bGV0SWQpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShleHBlbnNlcy5vdXRsZXRJZCwgb3V0bGV0SWQpKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgbXRkRXhwZW5zZXMgPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbShleHBlbnNlcylcbiAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpO1xuICAgIFxuICAgIGNvbnN0IGRhaWx5ID0gbXRkRXhwZW5zZXNcbiAgICAgIC5maWx0ZXIoZSA9PiBlLnR5cGUgPT09IFwiaGFyaWFuXCIpXG4gICAgICAucmVkdWNlKChzdW0sIGUpID0+IHN1bSArIGUuYW1vdW50LCAwKTtcbiAgICBcbiAgICBjb25zdCBtb250aGx5ID0gbXRkRXhwZW5zZXNcbiAgICAgIC5maWx0ZXIoZSA9PiBlLnR5cGUgPT09IFwiYnVsYW5hblwiKVxuICAgICAgLnJlZHVjZSgoc3VtLCBlKSA9PiBzdW0gKyBlLmFtb3VudCwgMCk7XG4gICAgXG4gICAgcmV0dXJuIHsgZGFpbHksIG1vbnRobHkgfTtcbiAgfVxuXG4gIC8vIEdldCBvdXRsZXQgc3VtbWFyeSBmb3IgYSBzcGVjaWZpYyBNVEQgcGVyaW9kXG4gIGFzeW5jIGdldE91dGxldE1URFN1bW1hcnkob3V0bGV0SWQ6IHN0cmluZywgZGF0ZTogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgdG90YWxTb2xkOiBudW1iZXI7XG4gICAgdG90YWxSZXZlbnVlOiBudW1iZXI7XG4gICAgdG90YWxDb2dzOiBudW1iZXI7XG4gICAgdG90YWxEYWlseUV4cGVuc2VzOiBudW1iZXI7XG4gICAgdG90YWxNb250aGx5RXhwZW5zZXM6IG51bWJlcjtcbiAgICBuZXRQcm9maXQ6IG51bWJlcjtcbiAgICBwZXJpb2RTdGFydDogc3RyaW5nO1xuICAgIHBlcmlvZEVuZDogc3RyaW5nO1xuICB9PiB7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuZ2V0TVREUGVyaW9kKGN1cnJlbnREYXRlKTtcbiAgICBcbiAgICBjb25zdCBtdGRTYWxlcyA9IGF3YWl0IHRoaXMuZ2V0TVREU2FsZXMoZGF0ZSwgb3V0bGV0SWQpO1xuICAgIGNvbnN0IG10ZEV4cGVuc2VzID0gYXdhaXQgdGhpcy5nZXRNVERFeHBlbnNlcyhkYXRlLCBvdXRsZXRJZCk7XG4gICAgXG4gICAgY29uc3QgdG90YWxTb2xkID0gbXRkU2FsZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMudG90YWxTb2xkLCAwKTtcbiAgICBjb25zdCB0b3RhbFJldmVudWUgPSBtdGRTYWxlcy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy50b3RhbFJldmVudWUsIDApO1xuICAgIGNvbnN0IHRvdGFsQ29ncyA9IG10ZFNhbGVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmNvZ3NTb2xkLCAwKTtcbiAgICBcbiAgICBjb25zdCBuZXRQcm9maXQgPSB0b3RhbFJldmVudWUgLSB0b3RhbENvZ3MgLSBtdGRFeHBlbnNlcy5kYWlseSAtIG10ZEV4cGVuc2VzLm1vbnRobHk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsU29sZCxcbiAgICAgIHRvdGFsUmV2ZW51ZSxcbiAgICAgIHRvdGFsQ29ncyxcbiAgICAgIHRvdGFsRGFpbHlFeHBlbnNlczogbXRkRXhwZW5zZXMuZGFpbHksXG4gICAgICB0b3RhbE1vbnRobHlFeHBlbnNlczogbXRkRXhwZW5zZXMubW9udGhseSxcbiAgICAgIG5ldFByb2ZpdCxcbiAgICAgIHBlcmlvZFN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXSxcbiAgICAgIHBlcmlvZEVuZDogZW5kLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdLFxuICAgIH07XG4gIH1cblxuICBhc3luYyBnZXRTYWxlcyhmaWx0ZXJzPzoge1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgb3V0bGV0SWQ/OiBzdHJpbmc7XG4gIH0pOiBQcm9taXNlPFNhbGVzW10+IHtcbiAgICBsZXQgcXVlcnkgPSBkYi5zZWxlY3QoKS5mcm9tKHNhbGVzKTtcblxuICAgIGNvbnN0IGNvbmRpdGlvbnMgPSBbXTtcbiAgICBpZiAoZmlsdGVycz8uZGF0ZSkge1xuICAgICAgY29uZGl0aW9ucy5wdXNoKGVxKHNhbGVzLmRhdGUsIGZpbHRlcnMuZGF0ZSkpO1xuICAgIH1cbiAgICBpZiAoZmlsdGVycz8ub3V0bGV0SWQpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShzYWxlcy5vdXRsZXRJZCwgZmlsdGVycy5vdXRsZXRJZCkpO1xuICAgIH1cblxuICAgIGlmIChjb25kaXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoYW5kKC4uLmNvbmRpdGlvbnMpKSBhcyBhbnk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnk7XG4gICAgcmV0dXJuIHJlc3VsdC5zb3J0KFxuICAgICAgKGEsIGIpID0+IG5ldyBEYXRlKGIuZGF0ZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKClcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgZ2V0U2FsZXNCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFNhbGVzIHwgdW5kZWZpbmVkPiB7XG4gICAgY29uc3QgW3NhbGVdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzYWxlcykud2hlcmUoZXEoc2FsZXMuaWQsIGlkKSk7XG4gICAgcmV0dXJuIHNhbGUgfHwgdW5kZWZpbmVkO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlU2FsZXMoaW5zZXJ0U2FsZXM6IEluc2VydFNhbGVzKTogUHJvbWlzZTxTYWxlcz4ge1xuICAgIGNvbnN0IFtzYWxlXSA9IGF3YWl0IGRiXG4gICAgICAuaW5zZXJ0KHNhbGVzKVxuICAgICAgLnZhbHVlcyhpbnNlcnRTYWxlcylcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICByZXR1cm4gc2FsZTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVNhbGVzKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgdXBkYXRlRGF0YTogUGFydGlhbDxJbnNlcnRTYWxlcz5cbiAgKTogUHJvbWlzZTxTYWxlcyB8IHVuZGVmaW5lZD4ge1xuICAgIGNvbnN0IFtzYWxlXSA9IGF3YWl0IGRiXG4gICAgICAudXBkYXRlKHNhbGVzKVxuICAgICAgLnNldCh7IC4uLnVwZGF0ZURhdGEsIHVwZGF0ZWRBdDogbmV3IERhdGUoKSB9KVxuICAgICAgLndoZXJlKGVxKHNhbGVzLmlkLCBpZCkpXG4gICAgICAucmV0dXJuaW5nKCk7XG4gICAgcmV0dXJuIHNhbGUgfHwgdW5kZWZpbmVkO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlU2FsZXMoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmRlbGV0ZShzYWxlcykud2hlcmUoZXEoc2FsZXMuaWQsIGlkKSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCAhPT0gbnVsbCAmJiByZXN1bHQucm93Q291bnQgPiAwO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVTYWxlc01ldHJpY3MoXG4gICAgc2FsZTogU2FsZXMsXG4gICAgb3V0bGV0PzogT3V0bGV0XG4gICk6IFNhbGVzV2l0aENhbGN1bGF0aW9ucyB7XG4gICAgY29uc3QgdG90YWxSZXZlbnVlID1cbiAgICAgIHNhbGUuY2FzaCArXG4gICAgICBzYWxlLnFyaXMgK1xuICAgICAgc2FsZS5ncmFiICtcbiAgICAgIHNhbGUuZ29mb29kICtcbiAgICAgIHNhbGUuc2hvcGVlICtcbiAgICAgIHNhbGUudGlrdG9rO1xuXG4gICAgY29uc3QgY29nc1BlclBpZWNlID0gb3V0bGV0Py5jb2dzUGVyUGllY2UgfHwgMDtcbiAgICBjb25zdCBjb2dzU29sZCA9IHNhbGUudG90YWxTb2xkICogY29nc1BlclBpZWNlO1xuICAgIGNvbnN0IGdyb3NzTWFyZ2luID0gdG90YWxSZXZlbnVlIC0gY29nc1NvbGQ7XG4gICAgY29uc3QgZ3Jvc3NNYXJnaW5QZXJjZW50YWdlID1cbiAgICAgIHRvdGFsUmV2ZW51ZSA+IDAgPyAoZ3Jvc3NNYXJnaW4gLyB0b3RhbFJldmVudWUpICogMTAwIDogMDtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5zYWxlLFxuICAgICAgdG90YWxSZXZlbnVlLFxuICAgICAgY29nc1NvbGQsXG4gICAgICBncm9zc01hcmdpbixcbiAgICAgIGdyb3NzTWFyZ2luUGVyY2VudGFnZSxcbiAgICAgIG91dGxldE5hbWU6IG91dGxldD8ubmFtZSxcbiAgICAgIGNvZ3NQZXJQaWVjZSxcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgZ2V0U2FsZXNXaXRoQ2FsY3VsYXRpb25zKGZpbHRlcnM/OiB7XG4gICAgZGF0ZT86IHN0cmluZztcbiAgICBvdXRsZXRJZD86IHN0cmluZztcbiAgfSk6IFByb21pc2U8U2FsZXNXaXRoQ2FsY3VsYXRpb25zW10+IHtcbiAgICBjb25zdCBzYWxlc0RhdGEgPSBhd2FpdCB0aGlzLmdldFNhbGVzKGZpbHRlcnMpO1xuICAgIGNvbnN0IG91dGxldHNEYXRhID0gYXdhaXQgdGhpcy5nZXRPdXRsZXRzKCk7XG4gICAgY29uc3Qgb3V0bGV0TWFwID0gbmV3IE1hcChvdXRsZXRzRGF0YS5tYXAoKG8pID0+IFtvLmlkLCBvXSkpO1xuXG4gICAgcmV0dXJuIHNhbGVzRGF0YS5tYXAoKHNhbGUpID0+XG4gICAgICB0aGlzLmNhbGN1bGF0ZVNhbGVzTWV0cmljcyhzYWxlLCBvdXRsZXRNYXAuZ2V0KHNhbGUub3V0bGV0SWQpKVxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGdldE1URFBlcmlvZChkYXRlOiBEYXRlKTogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH0ge1xuICAgIGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xuICAgIGNvbnN0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICBpZiAoZGF5ID49IDEwKSB7XG4gICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCAxMCk7XG4gICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIDkpO1xuICAgICAgZW5kLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSk7XG4gICAgICByZXR1cm4geyBzdGFydCwgZW5kIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCAxMCk7XG4gICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgOSk7XG4gICAgICBlbmQuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTtcbiAgICAgIHJldHVybiB7IHN0YXJ0LCBlbmQgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRNVERTYWxlcyhcbiAgICBkYXRlOiBzdHJpbmcsXG4gICAgb3V0bGV0SWQ/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxTYWxlc1dpdGhDYWxjdWxhdGlvbnNbXT4ge1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSB0aGlzLmdldE1URFBlcmlvZChjdXJyZW50RGF0ZSk7XG5cbiAgICBjb25zdCBzdGFydERhdGVTdHIgPSBzdGFydC50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXTtcbiAgICBjb25zdCBlbmREYXRlU3RyID0gZW5kLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdO1xuXG4gICAgY29uc3QgY29uZGl0aW9ucyA9IFtcbiAgICAgIGd0ZShzYWxlcy5kYXRlLCBzdGFydERhdGVTdHIpLFxuICAgICAgbHRlKHNhbGVzLmRhdGUsIGVuZERhdGVTdHIpLFxuICAgIF07XG5cbiAgICBpZiAob3V0bGV0SWQpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShzYWxlcy5vdXRsZXRJZCwgb3V0bGV0SWQpKTtcbiAgICB9XG5cbiAgICBjb25zdCBtdGRTYWxlcyA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKHNhbGVzKVxuICAgICAgLndoZXJlKGFuZCguLi5jb25kaXRpb25zKSk7XG5cbiAgICBjb25zdCBvdXRsZXRzRGF0YSA9IGF3YWl0IHRoaXMuZ2V0T3V0bGV0cygpO1xuICAgIGNvbnN0IG91dGxldE1hcCA9IG5ldyBNYXAob3V0bGV0c0RhdGEubWFwKChvKSA9PiBbby5pZCwgb10pKTtcblxuICAgIHJldHVybiBtdGRTYWxlc1xuICAgICAgLm1hcCgoc2FsZSkgPT4gdGhpcy5jYWxjdWxhdGVTYWxlc01ldHJpY3Moc2FsZSwgb3V0bGV0TWFwLmdldChzYWxlLm91dGxldElkKSkpXG4gICAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSk7XG4gIH1cblxuICBhc3luYyBnZXRNVERTdW1tYXJ5KGRhdGU6IHN0cmluZyk6IFByb21pc2U8TVREU3VtbWFyeVtdPiB7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuZ2V0TVREUGVyaW9kKGN1cnJlbnREYXRlKTtcblxuICAgIGNvbnN0IHN0YXJ0RGF0ZVN0ciA9IHN0YXJ0LnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdO1xuICAgIGNvbnN0IGVuZERhdGVTdHIgPSBlbmQudG9JU09TdHJpbmcoKS5zcGxpdChcIlRcIilbMF07XG5cbiAgICBjb25zdCBvdXRsZXRzRGF0YSA9IGF3YWl0IHRoaXMuZ2V0T3V0bGV0cygpO1xuICAgIGNvbnN0IG10ZFNhbGVzID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLmZyb20oc2FsZXMpXG4gICAgICAud2hlcmUoYW5kKGd0ZShzYWxlcy5kYXRlLCBzdGFydERhdGVTdHIpLCBsdGUoc2FsZXMuZGF0ZSwgZW5kRGF0ZVN0cikpKTtcblxuICAgIGNvbnN0IG91dGxldE1hcCA9IG5ldyBNYXAob3V0bGV0c0RhdGEubWFwKChvKSA9PiBbby5pZCwgb10pKTtcblxuICAgIGNvbnN0IHN1bW1hcnlNYXAgPSBuZXcgTWFwPHN0cmluZywgTVREU3VtbWFyeT4oKTtcblxuICAgIGZvciAoY29uc3Qgb3V0bGV0IG9mIG91dGxldHNEYXRhKSB7XG4gICAgICBjb25zdCBvdXRsZXRTYWxlcyA9IG10ZFNhbGVzLmZpbHRlcigocykgPT4gcy5vdXRsZXRJZCA9PT0gb3V0bGV0LmlkKTtcblxuICAgICAgY29uc3QgZGFpbHlTYWxlcyA9IG91dGxldFNhbGVzLm1hcCgoc2FsZSkgPT4ge1xuICAgICAgICBjb25zdCBtZXRyaWNzID0gdGhpcy5jYWxjdWxhdGVTYWxlc01ldHJpY3Moc2FsZSwgb3V0bGV0KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRlOiBzYWxlLmRhdGUsXG4gICAgICAgICAgcmV2ZW51ZTogbWV0cmljcy50b3RhbFJldmVudWUsXG4gICAgICAgICAgZ3Jvc3NNYXJnaW46IG1ldHJpY3MuZ3Jvc3NNYXJnaW4sXG4gICAgICAgICAgdW5pdHNTb2xkOiBzYWxlLnRvdGFsU29sZCxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b3RhbFJldmVudWUgPSBkYWlseVNhbGVzLnJlZHVjZSgoc3VtLCBkKSA9PiBzdW0gKyBkLnJldmVudWUsIDApO1xuICAgICAgY29uc3QgdG90YWxHcm9zc01hcmdpbiA9IGRhaWx5U2FsZXMucmVkdWNlKFxuICAgICAgICAoc3VtLCBkKSA9PiBzdW0gKyBkLmdyb3NzTWFyZ2luLFxuICAgICAgICAwXG4gICAgICApO1xuICAgICAgY29uc3QgdG90YWxTb2xkID0gZGFpbHlTYWxlcy5yZWR1Y2UoKHN1bSwgZCkgPT4gc3VtICsgZC51bml0c1NvbGQsIDApO1xuICAgICAgY29uc3QgYXZnR3Jvc3NNYXJnaW5QZXJjZW50YWdlID1cbiAgICAgICAgdG90YWxSZXZlbnVlID4gMCA/ICh0b3RhbEdyb3NzTWFyZ2luIC8gdG90YWxSZXZlbnVlKSAqIDEwMCA6IDA7XG5cbiAgICAgIHN1bW1hcnlNYXAuc2V0KG91dGxldC5pZCwge1xuICAgICAgICBvdXRsZXRJZDogb3V0bGV0LmlkLFxuICAgICAgICBvdXRsZXROYW1lOiBvdXRsZXQubmFtZSxcbiAgICAgICAgdG90YWxSZXZlbnVlLFxuICAgICAgICB0b3RhbFNvbGQsXG4gICAgICAgIHRvdGFsR3Jvc3NNYXJnaW4sXG4gICAgICAgIGF2Z0dyb3NzTWFyZ2luUGVyY2VudGFnZSxcbiAgICAgICAgZGFpbHlTYWxlcyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBBcnJheS5mcm9tKHN1bW1hcnlNYXAudmFsdWVzKCkpLnNvcnQoXG4gICAgICAoYSwgYikgPT4gYi50b3RhbEdyb3NzTWFyZ2luIC0gYS50b3RhbEdyb3NzTWFyZ2luXG4gICAgKTtcbiAgfVxuXG4gIC8vIEV4cGVuc2Ugb3BlcmF0aW9uc1xuICBhc3luYyBnZXRFeHBlbnNlcyhmaWx0ZXJzPzoge1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgb3V0bGV0SWQ/OiBzdHJpbmc7XG4gICAgdHlwZT86IFwiaGFyaWFuXCIgfCBcImJ1bGFuYW5cIjtcbiAgfSk6IFByb21pc2U8RXhwZW5zZVtdPiB7XG4gICAgbGV0IHF1ZXJ5ID0gZGIuc2VsZWN0KCkuZnJvbShleHBlbnNlcyk7XG5cbiAgICBjb25zdCBjb25kaXRpb25zID0gW107XG4gICAgaWYgKGZpbHRlcnM/LmRhdGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShleHBlbnNlcy5kYXRlLCBmaWx0ZXJzLmRhdGUpKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnM/Lm91dGxldElkKSB7XG4gICAgICBjb25kaXRpb25zLnB1c2goZXEoZXhwZW5zZXMub3V0bGV0SWQsIGZpbHRlcnMub3V0bGV0SWQpKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnM/LnR5cGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShleHBlbnNlcy50eXBlLCBmaWx0ZXJzLnR5cGUpKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZGl0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKGFuZCguLi5jb25kaXRpb25zKSkgYXMgYW55O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5O1xuICAgIHJldHVybiByZXN1bHQuc29ydChcbiAgICAgIChhLCBiKSA9PiBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEuZGF0ZSkuZ2V0VGltZSgpXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGdldEV4cGVuc2VCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEV4cGVuc2UgfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCBbZXhwZW5zZV0gPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKGV4cGVuc2VzKS53aGVyZShlcShleHBlbnNlcy5pZCwgaWQpKTtcbiAgICByZXR1cm4gZXhwZW5zZSB8fCB1bmRlZmluZWQ7XG4gIH1cblxuICBhc3luYyBjcmVhdGVFeHBlbnNlKGluc2VydEV4cGVuc2U6IEluc2VydEV4cGVuc2UpOiBQcm9taXNlPEV4cGVuc2U+IHtcbiAgICBjb25zdCBbZXhwZW5zZV0gPSBhd2FpdCBkYlxuICAgICAgLmluc2VydChleHBlbnNlcylcbiAgICAgIC52YWx1ZXMoaW5zZXJ0RXhwZW5zZSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICByZXR1cm4gZXhwZW5zZTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUV4cGVuc2UoXG4gICAgaWQ6IHN0cmluZyxcbiAgICBpbnNlcnRFeHBlbnNlOiBQYXJ0aWFsPEluc2VydEV4cGVuc2U+XG4gICk6IFByb21pc2U8RXhwZW5zZSB8IHVuZGVmaW5lZD4ge1xuICAgIGNvbnN0IFtleHBlbnNlXSA9IGF3YWl0IGRiXG4gICAgICAudXBkYXRlKGV4cGVuc2VzKVxuICAgICAgLnNldCh7XG4gICAgICAgIC4uLmluc2VydEV4cGVuc2UsXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH0pXG4gICAgICAud2hlcmUoZXEoZXhwZW5zZXMuaWQsIGlkKSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICByZXR1cm4gZXhwZW5zZSB8fCB1bmRlZmluZWQ7XG4gIH1cblxuICBhc3luYyBkZWxldGVFeHBlbnNlKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5kZWxldGUoZXhwZW5zZXMpLndoZXJlKGVxKGV4cGVuc2VzLmlkLCBpZCkpO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgIT09IG51bGwgJiYgcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIGFzeW5jIGdldEV4cGVuc2VzV2l0aE91dGxldChmaWx0ZXJzPzoge1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgb3V0bGV0SWQ/OiBzdHJpbmc7XG4gICAgdHlwZT86IFwiaGFyaWFuXCIgfCBcImJ1bGFuYW5cIjtcbiAgfSk6IFByb21pc2U8RXhwZW5zZVdpdGhPdXRsZXRbXT4ge1xuICAgIGNvbnN0IGV4cGVuc2VzRGF0YSA9IGF3YWl0IHRoaXMuZ2V0RXhwZW5zZXMoZmlsdGVycyk7XG4gICAgY29uc3Qgb3V0bGV0c0RhdGEgPSBhd2FpdCB0aGlzLmdldE91dGxldHMoKTtcblxuICAgIGNvbnN0IG91dGxldE1hcCA9IG5ldyBNYXAob3V0bGV0c0RhdGEubWFwKChvKSA9PiBbby5pZCwgb10pKTtcblxuICAgIHJldHVybiBleHBlbnNlc0RhdGEubWFwKChleHBlbnNlKSA9PiAoe1xuICAgICAgLi4uZXhwZW5zZSxcbiAgICAgIG91dGxldE5hbWU6IG91dGxldE1hcC5nZXQoZXhwZW5zZS5vdXRsZXRJZCk/Lm5hbWUsXG4gICAgfSkpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzdG9yYWdlID0gbmV3IERhdGFiYXNlU3RvcmFnZSgpO1xuIl0sIm5hbWVzIjpbIm91dGxldHMiLCJzYWxlcyIsInVzZXJzIiwiZXhwZW5zZXMiLCJkYiIsImVxIiwiYW5kIiwiZ3RlIiwibHRlIiwibmUiLCJpc05vdE51bGwiLCJEYXRhYmFzZVN0b3JhZ2UiLCJnZXRVc2VyIiwiaWQiLCJ1c2VyIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwiZ2V0VXNlckJ5RW1haWwiLCJlbWFpbCIsInVwc2VydFVzZXIiLCJ1c2VyRGF0YSIsImluc2VydCIsInZhbHVlcyIsIm9uQ29uZmxpY3REb1VwZGF0ZSIsInRhcmdldCIsInNldCIsInVwZGF0ZWRBdCIsIkRhdGUiLCJyZXR1cm5pbmciLCJnZXRBZG1pblVzZXJzIiwiYWRtaW5Vc2VycyIsInBhc3N3b3JkIiwicm9sZSIsInNvcnQiLCJhIiwiYiIsImNyZWF0ZWRBdCIsImdldFRpbWUiLCJjcmVhdGVBZG1pblVzZXIiLCJkYXRhIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJhc3NpZ25lZE91dGxldElkIiwiZGVsZXRlQWRtaW5Vc2VyIiwicmVzdWx0IiwiZGVsZXRlIiwicm93Q291bnQiLCJnZXRPdXRsZXRzIiwiZ2V0T3V0bGV0Iiwib3V0bGV0IiwidW5kZWZpbmVkIiwiY3JlYXRlT3V0bGV0IiwiaW5zZXJ0T3V0bGV0IiwidXBkYXRlT3V0bGV0IiwidXBkYXRlIiwiZGVsZXRlT3V0bGV0Iiwib3V0bGV0SWQiLCJkZWxldGVTYWxlc0J5T3V0bGV0IiwiZ2V0TVRERXhwZW5zZXMiLCJkYXRlIiwiY3VycmVudERhdGUiLCJzdGFydCIsImVuZCIsImdldE1URFBlcmlvZCIsInN0YXJ0RGF0ZVN0ciIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJlbmREYXRlU3RyIiwiY29uZGl0aW9ucyIsInB1c2giLCJtdGRFeHBlbnNlcyIsImRhaWx5IiwiZmlsdGVyIiwiZSIsInR5cGUiLCJyZWR1Y2UiLCJzdW0iLCJhbW91bnQiLCJtb250aGx5IiwiZ2V0T3V0bGV0TVREU3VtbWFyeSIsIm10ZFNhbGVzIiwiZ2V0TVREU2FsZXMiLCJ0b3RhbFNvbGQiLCJzIiwidG90YWxSZXZlbnVlIiwidG90YWxDb2dzIiwiY29nc1NvbGQiLCJuZXRQcm9maXQiLCJ0b3RhbERhaWx5RXhwZW5zZXMiLCJ0b3RhbE1vbnRobHlFeHBlbnNlcyIsInBlcmlvZFN0YXJ0IiwicGVyaW9kRW5kIiwiZ2V0U2FsZXMiLCJmaWx0ZXJzIiwicXVlcnkiLCJsZW5ndGgiLCJnZXRTYWxlc0J5SWQiLCJzYWxlIiwiY3JlYXRlU2FsZXMiLCJpbnNlcnRTYWxlcyIsInVwZGF0ZVNhbGVzIiwidXBkYXRlRGF0YSIsImRlbGV0ZVNhbGVzIiwiY2FsY3VsYXRlU2FsZXNNZXRyaWNzIiwiY2FzaCIsInFyaXMiLCJncmFiIiwiZ29mb29kIiwic2hvcGVlIiwidGlrdG9rIiwiY29nc1BlclBpZWNlIiwiZ3Jvc3NNYXJnaW4iLCJncm9zc01hcmdpblBlcmNlbnRhZ2UiLCJvdXRsZXROYW1lIiwibmFtZSIsImdldFNhbGVzV2l0aENhbGN1bGF0aW9ucyIsInNhbGVzRGF0YSIsIm91dGxldHNEYXRhIiwib3V0bGV0TWFwIiwiTWFwIiwibWFwIiwibyIsImdldCIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwic2V0SG91cnMiLCJnZXRNVERTdW1tYXJ5Iiwic3VtbWFyeU1hcCIsIm91dGxldFNhbGVzIiwiZGFpbHlTYWxlcyIsIm1ldHJpY3MiLCJyZXZlbnVlIiwidW5pdHNTb2xkIiwiZCIsInRvdGFsR3Jvc3NNYXJnaW4iLCJhdmdHcm9zc01hcmdpblBlcmNlbnRhZ2UiLCJBcnJheSIsImdldEV4cGVuc2VzIiwiZ2V0RXhwZW5zZUJ5SWQiLCJleHBlbnNlIiwiY3JlYXRlRXhwZW5zZSIsImluc2VydEV4cGVuc2UiLCJ1cGRhdGVFeHBlbnNlIiwiZGVsZXRlRXhwZW5zZSIsImdldEV4cGVuc2VzV2l0aE91dGxldCIsImV4cGVuc2VzRGF0YSIsInN0b3JhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/db/storage.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getOidcConfig: () => (/* binding */ getOidcConfig),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   sessionOptions: () => (/* binding */ sessionOptions),\n/* harmony export */   upsertUserFromClaims: () => (/* binding */ upsertUserFromClaims)\n/* harmony export */ });\n/* harmony import */ var openid_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! openid-client */ \"(rsc)/./node_modules/openid-client/build/index.js\");\n/* harmony import */ var iron_session__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! iron-session */ \"(rsc)/./node_modules/iron-session/dist/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var memoizee__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! memoizee */ \"(rsc)/./node_modules/memoizee/index.js\");\n/* harmony import */ var memoizee__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(memoizee__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _db_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/db/storage */ \"(rsc)/./src/db/storage.ts\");\n\n\n\n\n\nconst sessionOptions = {\n    password: process.env.SESSION_SECRET,\n    cookieName: \"pukis_session\",\n    cookieOptions: {\n        secure: \"development\" === \"production\",\n        httpOnly: true,\n        sameSite: \"lax\",\n        maxAge: 7 * 24 * 60 * 60\n    }\n};\nconst getOidcConfig = memoizee__WEBPACK_IMPORTED_MODULE_1___default()(async ()=>{\n    return await openid_client__WEBPACK_IMPORTED_MODULE_3__.discovery(new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"), process.env.REPL_ID);\n}, {\n    maxAge: 3600 * 1000\n});\nasync function getSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    return (0,iron_session__WEBPACK_IMPORTED_MODULE_4__.getIronSession)(cookieStore, sessionOptions);\n}\nasync function getCurrentUser() {\n    const session = await getSession();\n    if (!session.user || !session.expiresAt) {\n        return null;\n    }\n    const now = Math.floor(Date.now() / 1000);\n    if (now <= session.expiresAt) {\n        const user = await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.getUser(session.user.id);\n        return user;\n    }\n    if (!session.refreshToken) {\n        return null;\n    }\n    try {\n        const config = await getOidcConfig();\n        const tokenResponse = await openid_client__WEBPACK_IMPORTED_MODULE_3__.refreshTokenGrant(config, session.refreshToken);\n        const claims = tokenResponse.claims();\n        session.accessToken = tokenResponse.access_token;\n        session.refreshToken = tokenResponse.refresh_token;\n        session.expiresAt = claims?.exp;\n        await session.save();\n        const user = await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.getUser(session.user.id);\n        return user;\n    } catch (error) {\n        console.error(\"Failed to refresh token:\", error);\n        return null;\n    }\n}\nasync function upsertUserFromClaims(claims) {\n    const existingUserById = await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.getUser(claims.sub);\n    if (!existingUserById && claims.email) {\n        const existingUserByEmail = await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.getUserByEmail(claims.email);\n        if (existingUserByEmail) {\n            if (existingUserByEmail.password) {\n                throw new Error(\"Email ini sudah terdaftar sebagai akun admin. Silakan login melalui halaman Admin Login.\");\n            }\n            return await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.upsertUser({\n                id: existingUserByEmail.id,\n                email: claims.email,\n                firstName: claims.first_name,\n                lastName: claims.last_name,\n                profileImageUrl: claims.profile_image_url,\n                role: existingUserByEmail.role\n            });\n        }\n    }\n    return await _db_storage__WEBPACK_IMPORTED_MODULE_2__.storage.upsertUser({\n        id: claims.sub,\n        email: claims.email,\n        firstName: claims.first_name,\n        lastName: claims.last_name,\n        profileImageUrl: claims.profile_image_url,\n        role: existingUserById?.role || \"finance\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQ2RDLE9BQU9YLE9BQU9XLEtBQUs7UUFDbkJLLFdBQVdoQixPQUFPaUIsVUFBVTtRQUM1QkMsVUFBVWxCLE9BQU9tQixTQUFTO1FBQzFCQyxpQkFBaUJwQixPQUFPcUIsaUJBQWlCO1FBQ3pDQyxNQUFNYixrQkFBa0JhLFFBQVE7SUFDbEM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Jlc3QtZXhwcmVzcy8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNsaWVudCBmcm9tIFwib3BlbmlkLWNsaWVudFwiO1xuaW1wb3J0IHsgZ2V0SXJvblNlc3Npb24sIFNlc3Npb25PcHRpb25zIH0gZnJvbSBcImlyb24tc2Vzc2lvblwiO1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCBtZW1vaXplIGZyb20gXCJtZW1vaXplZVwiO1xuaW1wb3J0IHsgc3RvcmFnZSB9IGZyb20gXCJAL2RiL3N0b3JhZ2VcIjtcblxuZXhwb3J0IGludGVyZmFjZSBTZXNzaW9uRGF0YSB7XG4gIHVzZXI/OiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBlbWFpbD86IHN0cmluZztcbiAgICBmaXJzdE5hbWU/OiBzdHJpbmc7XG4gICAgbGFzdE5hbWU/OiBzdHJpbmc7XG4gICAgcHJvZmlsZUltYWdlVXJsPzogc3RyaW5nO1xuICAgIHJvbGU/OiBzdHJpbmc7XG4gIH07XG4gIGFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICByZWZyZXNoVG9rZW4/OiBzdHJpbmc7XG4gIGV4cGlyZXNBdD86IG51bWJlcjtcbiAgY29kZVZlcmlmaWVyPzogc3RyaW5nO1xuICBzdGF0ZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IHNlc3Npb25PcHRpb25zOiBTZXNzaW9uT3B0aW9ucyA9IHtcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LlNFU1NJT05fU0VDUkVUISxcbiAgY29va2llTmFtZTogXCJwdWtpc19zZXNzaW9uXCIsXG4gIGNvb2tpZU9wdGlvbnM6IHtcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIixcbiAgICBodHRwT25seTogdHJ1ZSxcbiAgICBzYW1lU2l0ZTogXCJsYXhcIiBhcyBjb25zdCxcbiAgICBtYXhBZ2U6IDcgKiAyNCAqIDYwICogNjAsXG4gIH0sXG59O1xuXG5leHBvcnQgY29uc3QgZ2V0T2lkY0NvbmZpZyA9IG1lbW9pemUoXG4gIGFzeW5jICgpID0+IHtcbiAgICByZXR1cm4gYXdhaXQgY2xpZW50LmRpc2NvdmVyeShcbiAgICAgIG5ldyBVUkwocHJvY2Vzcy5lbnYuSVNTVUVSX1VSTCA/PyBcImh0dHBzOi8vcmVwbGl0LmNvbS9vaWRjXCIpLFxuICAgICAgcHJvY2Vzcy5lbnYuUkVQTF9JRCFcbiAgICApO1xuICB9LFxuICB7IG1heEFnZTogMzYwMCAqIDEwMDAgfVxuKTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb24oKSB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICByZXR1cm4gZ2V0SXJvblNlc3Npb248U2Vzc2lvbkRhdGE+KGNvb2tpZVN0b3JlLCBzZXNzaW9uT3B0aW9ucyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKTtcbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyIHx8ICFzZXNzaW9uLmV4cGlyZXNBdCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XG4gIFxuICBpZiAobm93IDw9IHNlc3Npb24uZXhwaXJlc0F0KSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHN0b3JhZ2UuZ2V0VXNlcihzZXNzaW9uLnVzZXIuaWQpO1xuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgaWYgKCFzZXNzaW9uLnJlZnJlc2hUb2tlbikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCBnZXRPaWRjQ29uZmlnKCk7XG4gICAgY29uc3QgdG9rZW5SZXNwb25zZSA9IGF3YWl0IGNsaWVudC5yZWZyZXNoVG9rZW5HcmFudChjb25maWcsIHNlc3Npb24ucmVmcmVzaFRva2VuKTtcbiAgICBjb25zdCBjbGFpbXMgPSB0b2tlblJlc3BvbnNlLmNsYWltcygpO1xuICAgIFxuICAgIHNlc3Npb24uYWNjZXNzVG9rZW4gPSB0b2tlblJlc3BvbnNlLmFjY2Vzc190b2tlbjtcbiAgICBzZXNzaW9uLnJlZnJlc2hUb2tlbiA9IHRva2VuUmVzcG9uc2UucmVmcmVzaF90b2tlbjtcbiAgICBzZXNzaW9uLmV4cGlyZXNBdCA9IGNsYWltcz8uZXhwO1xuICAgIGF3YWl0IHNlc3Npb24uc2F2ZSgpO1xuICAgIFxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBzdG9yYWdlLmdldFVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICByZXR1cm4gdXNlcjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJlZnJlc2ggdG9rZW46XCIsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0VXNlckZyb21DbGFpbXMoY2xhaW1zOiBhbnkpIHtcbiAgY29uc3QgZXhpc3RpbmdVc2VyQnlJZCA9IGF3YWl0IHN0b3JhZ2UuZ2V0VXNlcihjbGFpbXMuc3ViKTtcbiAgXG4gIGlmICghZXhpc3RpbmdVc2VyQnlJZCAmJiBjbGFpbXMuZW1haWwpIHtcbiAgICBjb25zdCBleGlzdGluZ1VzZXJCeUVtYWlsID0gYXdhaXQgc3RvcmFnZS5nZXRVc2VyQnlFbWFpbChjbGFpbXMuZW1haWwpO1xuICAgIGlmIChleGlzdGluZ1VzZXJCeUVtYWlsKSB7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyQnlFbWFpbC5wYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWFpbCBpbmkgc3VkYWggdGVyZGFmdGFyIHNlYmFnYWkgYWt1biBhZG1pbi4gU2lsYWthbiBsb2dpbiBtZWxhbHVpIGhhbGFtYW4gQWRtaW4gTG9naW4uXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF3YWl0IHN0b3JhZ2UudXBzZXJ0VXNlcih7XG4gICAgICAgIGlkOiBleGlzdGluZ1VzZXJCeUVtYWlsLmlkLFxuICAgICAgICBlbWFpbDogY2xhaW1zLmVtYWlsLFxuICAgICAgICBmaXJzdE5hbWU6IGNsYWltcy5maXJzdF9uYW1lLFxuICAgICAgICBsYXN0TmFtZTogY2xhaW1zLmxhc3RfbmFtZSxcbiAgICAgICAgcHJvZmlsZUltYWdlVXJsOiBjbGFpbXMucHJvZmlsZV9pbWFnZV91cmwsXG4gICAgICAgIHJvbGU6IGV4aXN0aW5nVXNlckJ5RW1haWwucm9sZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGF3YWl0IHN0b3JhZ2UudXBzZXJ0VXNlcih7XG4gICAgaWQ6IGNsYWltcy5zdWIsXG4gICAgZW1haWw6IGNsYWltcy5lbWFpbCxcbiAgICBmaXJzdE5hbWU6IGNsYWltcy5maXJzdF9uYW1lLFxuICAgIGxhc3ROYW1lOiBjbGFpbXMubGFzdF9uYW1lLFxuICAgIHByb2ZpbGVJbWFnZVVybDogY2xhaW1zLnByb2ZpbGVfaW1hZ2VfdXJsLFxuICAgIHJvbGU6IGV4aXN0aW5nVXNlckJ5SWQ/LnJvbGUgfHwgXCJmaW5hbmNlXCIsXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbImNsaWVudCIsImdldElyb25TZXNzaW9uIiwiY29va2llcyIsIm1lbW9pemUiLCJzdG9yYWdlIiwic2Vzc2lvbk9wdGlvbnMiLCJwYXNzd29yZCIsInByb2Nlc3MiLCJlbnYiLCJTRVNTSU9OX1NFQ1JFVCIsImNvb2tpZU5hbWUiLCJjb29raWVPcHRpb25zIiwic2VjdXJlIiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsIm1heEFnZSIsImdldE9pZGNDb25maWciLCJkaXNjb3ZlcnkiLCJVUkwiLCJJU1NVRVJfVVJMIiwiUkVQTF9JRCIsImdldFNlc3Npb24iLCJjb29raWVTdG9yZSIsImdldEN1cnJlbnRVc2VyIiwic2Vzc2lvbiIsInVzZXIiLCJleHBpcmVzQXQiLCJub3ciLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwiZ2V0VXNlciIsImlkIiwicmVmcmVzaFRva2VuIiwiY29uZmlnIiwidG9rZW5SZXNwb25zZSIsInJlZnJlc2hUb2tlbkdyYW50IiwiY2xhaW1zIiwiYWNjZXNzVG9rZW4iLCJhY2Nlc3NfdG9rZW4iLCJyZWZyZXNoX3Rva2VuIiwiZXhwIiwic2F2ZSIsImVycm9yIiwiY29uc29sZSIsInVwc2VydFVzZXJGcm9tQ2xhaW1zIiwiZXhpc3RpbmdVc2VyQnlJZCIsInN1YiIsImVtYWlsIiwiZXhpc3RpbmdVc2VyQnlFbWFpbCIsImdldFVzZXJCeUVtYWlsIiwiRXJyb3IiLCJ1cHNlcnRVc2VyIiwiZmlyc3ROYW1lIiwiZmlyc3RfbmFtZSIsImxhc3ROYW1lIiwibGFzdF9uYW1lIiwicHJvZmlsZUltYWdlVXJsIiwicHJvZmlsZV9pbWFnZV91cmwiLCJyb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod","vendor-chunks/drizzle-orm","vendor-chunks/drizzle-zod","vendor-chunks/@neondatabase","vendor-chunks/ws","vendor-chunks/oauth4webapi","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/memoizee","vendor-chunks/iron-session","vendor-chunks/es5-ext","vendor-chunks/iron-webcrypto","vendor-chunks/es6-symbol","vendor-chunks/node-gyp-build","vendor-chunks/event-emitter","vendor-chunks/next-tick","vendor-chunks/d","vendor-chunks/type","vendor-chunks/ext","vendor-chunks/lru-queue","vendor-chunks/bufferutil","vendor-chunks/uncrypto","vendor-chunks/timers-ext","vendor-chunks/is-promise"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();